<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>node笔记总纲 | Hexo</title>
  <meta name="description" content="本人笔记分享 全部笔记、Node笔记  NODE笔记总纲&#x3D;&gt;7_16~28笔记总结#目录 [TOC]  ———————–&#x3D;&#x3D;(NODE壹)&#x3D;&#x3D;————————-NODE基本语法&#x3D;&gt;Day7_16一.node入门基础知识与语法1.node官网API文档​		http:&#x2F;&#x2F;nodejs.cn&#x2F;api&#x2F;   2.控制台 启动nod">
<meta property="og:type" content="article">
<meta property="og:title" content="node笔记总纲">
<meta property="og:url" content="https://k705.github.io/2024/04/08/Nodejs-A_Node%E7%AC%94%E8%AE%B0%E6%80%BB%E7%BA%B2/index.html">
<meta property="og:site_name" content="KK">
<meta property="og:description" content="本人笔记分享 全部笔记、Node笔记  NODE笔记总纲&#x3D;&gt;7_16~28笔记总结#目录 [TOC]  ———————–&#x3D;&#x3D;(NODE壹)&#x3D;&#x3D;————————-NODE基本语法&#x3D;&gt;Day7_16一.node入门基础知识与语法1.node官网API文档​		http:&#x2F;&#x2F;nodejs.cn&#x2F;api&#x2F;   2.控制台 启动nod">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-04-08T06:36:10.000Z">
<meta property="article:modified_time" content="2024-04-09T08:49:42.231Z">
<meta property="article:author" content="KK">
<meta property="article:tag" content="nodejs">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="https://k705.github.io/2024/04/08/Nodejs-A_Node%E7%AC%94%E8%AE%B0%E6%80%BB%E7%BA%B2/index.html">
  
    <link rel="alternate" href="/atom.xml" title="KK" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="./css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 7.1.1"></head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/cofess" target="_blank">
          <img class="img-circle img-rotate" src="./images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">KK</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">前端工程师</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shanghai, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="./.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="./archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="./categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="./tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="./repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">项目</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-books">
          <a href="./books">
            
            <i class="icon icon-book-fill"></i>
            
            <span class="menu-title">书单</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="./links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">友链</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="./about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/cofess" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://weibo.com/cofess" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="https://twitter.com/iwebued" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
        <li><a href="https://www.behance.net/cofess" target="_blank" title="Behance" data-toggle=tooltip data-placement=top><i class="icon icon-behance"></i></a></li>
        
        <li><a href="./atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p>
            </div>
        </div>
    </div>
</div>

    
      

    
      
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="./tags/Ajax/" rel="tag">Ajax</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/AntDesign/" rel="tag">AntDesign</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/Axios/" rel="tag">Axios</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/CSS/" rel="tag">CSS</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/ES/" rel="tag">ES</a><span class="tag-list-count">25</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/Git/" rel="tag">Git</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/HTML-CSS/" rel="tag">HTML+CSS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/Html/" rel="tag">Html</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/JS/" rel="tag">JS</a><span class="tag-list-count">17</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/Java/" rel="tag">Java</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/Js/" rel="tag">Js</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/Js%E5%B7%A5%E5%85%B7%E5%BA%93/" rel="tag">Js工具库</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/Mysql/" rel="tag">Mysql</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/TS/" rel="tag">TS</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/Umi/" rel="tag">Umi</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/Vue/" rel="tag">Vue</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/Vue2/" rel="tag">Vue2</a><span class="tag-list-count">17</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/Vue3/" rel="tag">Vue3</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/antDesign/" rel="tag">antDesign</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/go/" rel="tag">go</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/jQuery/" rel="tag">jQuery</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/nodejs/" rel="tag">nodejs</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/react/" rel="tag">react</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/webpack/" rel="tag">webpack</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/" rel="tag">云服务器</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/" rel="tag">代码规范</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/%E5%89%8D%E7%AB%AFUI%E5%BA%93/" rel="tag">前端UI库</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/%E5%B0%81%E8%A3%85JavaScript%E5%B7%A5%E5%85%B7%E5%8C%85/" rel="tag">封装JavaScript工具包</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/%E5%B7%A5%E5%85%B7/" rel="tag">工具</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/%E5%BA%95%E5%B1%82%E7%9F%A5%E8%AF%86/" rel="tag">底层知识</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">微信小程序</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/%E5%BF%AB%E9%80%9F%E5%8F%82%E8%80%83%E5%A4%87%E5%BF%98%E6%B8%85%E5%8D%95/" rel="tag">快速参考备忘清单</a><span class="tag-list-count">34</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/%E6%AD%A3%E5%88%99/" rel="tag">正则</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/%E8%BD%AF%E4%BB%B6/" rel="tag">软件</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/%E9%85%8D%E7%BD%AE/" rel="tag">配置</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="./tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a><span class="tag-list-count">23</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="./tags/Ajax/" style="font-size: 13px;">Ajax</a> <a href="./tags/AntDesign/" style="font-size: 13px;">AntDesign</a> <a href="./tags/Axios/" style="font-size: 13.08px;">Axios</a> <a href="./tags/CSS/" style="font-size: 13.31px;">CSS</a> <a href="./tags/ES/" style="font-size: 13.92px;">ES</a> <a href="./tags/Git/" style="font-size: 13.23px;">Git</a> <a href="./tags/HTML-CSS/" style="font-size: 13px;">HTML+CSS</a> <a href="./tags/Html/" style="font-size: 13px;">Html</a> <a href="./tags/JS/" style="font-size: 13.77px;">JS</a> <a href="./tags/Java/" style="font-size: 13.54px;">Java</a> <a href="./tags/Js/" style="font-size: 13px;">Js</a> <a href="./tags/Js%E5%B7%A5%E5%85%B7%E5%BA%93/" style="font-size: 13.23px;">Js工具库</a> <a href="./tags/Mysql/" style="font-size: 13.08px;">Mysql</a> <a href="./tags/TS/" style="font-size: 13.15px;">TS</a> <a href="./tags/Umi/" style="font-size: 13.08px;">Umi</a> <a href="./tags/Vue/" style="font-size: 13.38px;">Vue</a> <a href="./tags/Vue2/" style="font-size: 13.77px;">Vue2</a> <a href="./tags/Vue3/" style="font-size: 13px;">Vue3</a> <a href="./tags/antDesign/" style="font-size: 13px;">antDesign</a> <a href="./tags/go/" style="font-size: 13px;">go</a> <a href="./tags/jQuery/" style="font-size: 13px;">jQuery</a> <a href="./tags/nodejs/" style="font-size: 13.46px;">nodejs</a> <a href="./tags/react/" style="font-size: 13.54px;">react</a> <a href="./tags/webpack/" style="font-size: 13.23px;">webpack</a> <a href="./tags/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 13.23px;">云服务器</a> <a href="./tags/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/" style="font-size: 13px;">代码规范</a> <a href="./tags/%E5%89%8D%E7%AB%AFUI%E5%BA%93/" style="font-size: 13.38px;">前端UI库</a> <a href="./tags/%E5%B0%81%E8%A3%85JavaScript%E5%B7%A5%E5%85%B7%E5%8C%85/" style="font-size: 13.69px;">封装JavaScript工具包</a> <a href="./tags/%E5%B7%A5%E5%85%B7/" style="font-size: 13.08px;">工具</a> <a href="./tags/%E5%BA%95%E5%B1%82%E7%9F%A5%E8%AF%86/" style="font-size: 13.62px;">底层知识</a> <a href="./tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 13px;">微信小程序</a> <a href="./tags/%E5%BF%AB%E9%80%9F%E5%8F%82%E8%80%83%E5%A4%87%E5%BF%98%E6%B8%85%E5%8D%95/" style="font-size: 14px;">快速参考备忘清单</a> <a href="./tags/%E6%AD%A3%E5%88%99/" style="font-size: 13.08px;">正则</a> <a href="./tags/%E8%BD%AF%E4%BB%B6/" style="font-size: 13.62px;">软件</a> <a href="./tags/%E9%85%8D%E7%BD%AE/" style="font-size: 13px;">配置</a> <a href="./tags/%E9%9D%A2%E8%AF%95/" style="font-size: 13.85px;">面试</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="./archives/2024/04/">四月 2024</a><span class="archive-list-count">241</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="./2024/04/25/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/" class="title">代码规范</a>
              </p>
              <p class="item-date">
                <time datetime="2024-04-25T09:08:57.000Z" itemprop="datePublished">2024-04-25</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="./2024/04/25/%E5%B7%A5%E5%85%B7-vscode%20%E5%8A%9F%E8%83%BD%E4%B8%8E%E6%8A%80%E5%B7%A7/" class="title">vscode 功能与技巧</a>
              </p>
              <p class="item-date">
                <time datetime="2024-04-25T03:22:46.000Z" itemprop="datePublished">2024-04-25</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="./2024/04/22/Vue3-pure-admin/" class="title">Vue3-pure-admin</a>
              </p>
              <p class="item-date">
                <time datetime="2024-04-22T01:58:28.000Z" itemprop="datePublished">2024-04-22</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="./2024/04/08/Ajax%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="title">Ajax笔记</a>
              </p>
              <p class="item-date">
                <time datetime="2024-04-08T06:36:10.000Z" itemprop="datePublished">2024-04-08</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="./2024/04/08/AntDesignOfReact%E5%B0%81%E8%A3%85-Table%E5%8F%8A%E5%85%B6%E7%AD%9B%E9%80%89%E7%BB%84%E4%BB%B6%E5%B0%81%E8%A3%85/" class="title">AntDesign封装</a>
              </p>
              <p class="item-date">
                <time datetime="2024-04-08T06:36:10.000Z" itemprop="datePublished">2024-04-08</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<main class="main" role="main">
  <div class="content">
  <article id="post-Nodejs-A_Node笔记总纲" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      node笔记总纲
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="./2024/04/08/Nodejs-A_Node%E7%AC%94%E8%AE%B0%E6%80%BB%E7%BA%B2/" class="article-date">
	  <time datetime="2024-04-08T06:36:10.000Z" itemprop="datePublished">2024-04-08</time>
	</a>
</span>
        
        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="./tags/nodejs/" rel="tag">nodejs</a>
  </span>


        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


        <span class="post-comment"><i class="icon icon-comment"></i> <a href="./2024/04/08/Nodejs-A_Node%E7%AC%94%E8%AE%B0%E6%80%BB%E7%BA%B2/#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <blockquote>
<p>本人笔记分享</p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/hongjilin/hongs-study-notes"><code>全部笔记</code></a>、<a target="_blank" rel="noopener" href="https://gitee.com/hongjilin/hongs-study-notes/tree/master/%E7%BC%96%E7%A8%8B_%E5%90%8E%E5%8F%B0%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Nodejs"><code>Node笔记</code></a></p>
</blockquote>
<h1 id="NODE笔记总纲-7-16-28笔记总结"><a href="#NODE笔记总纲-7-16-28笔记总结" class="headerlink" title="NODE笔记总纲&#x3D;&gt;7_16~28笔记总结"></a>NODE笔记总纲&#x3D;&gt;7_16~28笔记总结</h1><h1 id="目录"><a href="#目录" class="headerlink" title="#目录"></a>#目录</h1><blockquote>
<p>[TOC]</p>
</blockquote>
<h1 id="———————–-NODE壹-————————"><a href="#———————–-NODE壹-————————" class="headerlink" title="———————–&#x3D;&#x3D;(NODE壹)&#x3D;&#x3D;————————-"></a>———————–&#x3D;&#x3D;(NODE壹)&#x3D;&#x3D;————————-</h1><h1 id="NODE基本语法-Day7-16"><a href="#NODE基本语法-Day7-16" class="headerlink" title="NODE基本语法&#x3D;&gt;Day7_16"></a><strong>NODE基本语法&#x3D;&gt;Day7_16</strong></h1><h2 id="一-node入门基础知识与语法"><a href="#一-node入门基础知识与语法" class="headerlink" title="一.node入门基础知识与语法"></a>一.node入门基础知识与语法</h2><h5 id="1-node官网API文档"><a href="#1-node官网API文档" class="headerlink" title="1.node官网API文档"></a>1.node官网API文档</h5><p>​		<a target="_blank" rel="noopener" href="http://nodejs.cn/api/">http://nodejs.cn/api/</a>  </p>
<h5 id="2-控制台-启动node项目代码"><a href="#2-控制台-启动node项目代码" class="headerlink" title="2.控制台 启动node项目代码"></a>2.控制台 启动node项目代码</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run start</span><br></pre></td></tr></table></figure>

<h5 id="3-JS能做与不能做的事情"><a href="#3-JS能做与不能做的事情" class="headerlink" title="3.JS能做与不能做的事情:"></a>3.JS能做与不能做的事情:</h5><pre><code>       ①js能做:操作css  操作dom 执行常规函数方法 前后端通信
</code></pre>
<p>​			②js不能做:不能链接数据库操作文件系统</p>
<h5 id="4-node-async-异步-api基础知识点"><a href="#4-node-async-异步-api基础知识点" class="headerlink" title="4.node async(异步) api基础知识点:"></a>4.node async(异步) api基础知识点:</h5><p>​		① 同步是请求与响应同步在一起,异步是不在一起</p>
<p>​		② 回调函数的至少有一个形参,而且在第一个位置,而且是error</p>
<h5 id="5-阻塞非阻塞区别"><a href="#5-阻塞非阻塞区别" class="headerlink" title="5.阻塞非阻塞区别 :"></a>5.阻塞非阻塞区别 :</h5><p>​       ①单线程阻塞,多线程非阻塞</p>
<h2 id="二-基于命令行的实行生成express"><a href="#二-基于命令行的实行生成express" class="headerlink" title="二.基于命令行的实行生成express"></a>二.基于命令行的实行生成express</h2><p><code> 1、npm install express-generator -g</code><br><code> 2、express 项目名称 // 表示在当前目录下生成一个项目</code></p>
<h2 id="三-常用基础代码操作"><a href="#三-常用基础代码操作" class="headerlink" title="三.常用基础代码操作"></a>三.常用基础代码操作</h2><h5 id="1-引用包"><a href="#1-引用包" class="headerlink" title="1. 引用包"></a>1. 引用包</h5><p><code>const mypackage= require(&#39;./mypachage&#39;);</code></p>
<h5 id="2-文件操作"><a href="#2-文件操作" class="headerlink" title="2.文件操作"></a>2.文件操作</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//①写入</span></span><br><span class="line">fs.<span class="title function_">writeFile</span>(<span class="string">&#x27;./fs.txt&#x27;</span>,<span class="string">&#x27;Hong&#x27;</span>,<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//错误优先原则</span></span><br><span class="line">    <span class="keyword">if</span> (e)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(e);<span class="keyword">return</span> ;</span><br><span class="line">    &#125;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;成功&quot;</span>);</span><br><span class="line">    <span class="comment">//同步fs.writeFileSync(&#x27;./fs.txt&#x27;,new Date())</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//②读取</span></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./fs.txt&#x27;</span>,<span class="function">(<span class="params">e,data</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (e)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(e);<span class="keyword">return</span> ;</span><br><span class="line">    &#125;<span class="variable language_">console</span>.<span class="title function_">log</span>(data.<span class="title function_">toString</span>());</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="3-同步异常捕获"><a href="#3-同步异常捕获" class="headerlink" title="3.同步异常捕获"></a>3.同步异常捕获</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    let data=fs.readFileSync(&#x27;./fs.txt&#x27;)</span><br><span class="line">    console.log(&quot;成功&quot;);</span><br><span class="line">    console.log(data.toString());</span><br><span class="line">&#125;catch (e) &#123;</span><br><span class="line">    console.error(&#x27;出错&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="4-路径函数"><a href="#4-路径函数" class="headerlink" title="4.路径函数"></a>4.路径函数</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">const  path=require(&#x27;path&#x27;);</span><br><span class="line">//参数中...是可选参数(任意)</span><br><span class="line">console.log(path.join(&#x27;a&#x27;,&#x27;../b&#x27;,&#x27;c&#x27;))</span><br><span class="line">console.log(path.basename(&#x27;./fs.txt&#x27;));</span><br><span class="line">console.log(path.dirname(&#x27;f./fs.txt&#x27;));</span><br><span class="line">console.log(path.extname(&#x27;./fs.txt&#x27;));*/</span><br><span class="line">//获取当前目录路径</span><br><span class="line">console.log(__dirname);</span><br><span class="line">//获取当前目录文件路径,包括当前路径</span><br><span class="line">console.log(__filename);</span><br></pre></td></tr></table></figure>

<h5 id="5-美化日志-在bin包中的www替换onListening"><a href="#5-美化日志-在bin包中的www替换onListening" class="headerlink" title="5.美化日志&#x3D;&gt;(在bin包中的www替换onListening)"></a>5.美化日志&#x3D;&gt;(在bin包中的www替换onListening)</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getPackageJson</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// console.log(&#x27;----------------------1.开始读取package.json&#x27;)</span></span><br><span class="line">    <span class="keyword">var</span> _packageJson = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;./package.json&#x27;</span>)</span><br><span class="line">    <span class="comment">// console.log(&#x27;----------------------读取package.json文件完毕&#x27;)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>(_packageJson)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onListening</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> addr = server.<span class="title function_">address</span>();</span><br><span class="line">    <span class="keyword">var</span> bind = <span class="keyword">typeof</span> addr === <span class="string">&#x27;string&#x27;</span></span><br><span class="line">        ? <span class="string">&#x27;pipe &#x27;</span> + addr</span><br><span class="line">        : <span class="string">&#x27;port &#x27;</span> + addr.<span class="property">port</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`</span></span><br><span class="line"><span class="string">#    _____                     .___</span></span><br><span class="line"><span class="string">#  _/ ____\\  ____    ____    __| _/  ____</span></span><br><span class="line"><span class="string">#  \\   __\\  /    \\  /  _ \\  / __ | _/ __ \\</span></span><br><span class="line"><span class="string">#   |  |   |   |  \\(  &lt;_&gt; )/ /_/ | \\  ___/</span></span><br><span class="line"><span class="string">#   |__|   |___|  / \\____/ \\____ |  \\___  &gt;</span></span><br><span class="line"><span class="string">#               \\/              \\/      \\/</span></span><br><span class="line"><span class="string">=============================================</span></span><br><span class="line"><span class="string">fnode :: (v0.0.1RELEASE)</span></span><br><span class="line"><span class="string">        `</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[SYSTERM]<span class="subst">$&#123;getPackageJson().name&#125;</span>应用启动中...`</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[SYSTERM]应用部署在<span class="subst">$&#123;bind&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="6-node热更新-package-json中修改"><a href="#6-node热更新-package-json中修改" class="headerlink" title="6.node热更新&#x3D;&gt;(package.json中修改)"></a>6.node热更新&#x3D;&gt;(package.json中修改)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;start&quot;: &quot;nodemon ./bin/www&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h5 id="7-app-js可改部分"><a href="#7-app-js可改部分" class="headerlink" title="7.app.js可改部分"></a>7.app.js可改部分</h5><p>1.引用路由 可改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*var usersRouter = require(&#x27;./routes/users&#x27;);</span><br></pre></td></tr></table></figure>

<p>2.路由注册</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(&#x27;/users&#x27;, usersRouter);</span><br></pre></td></tr></table></figure>

<h6 id=""><a href="#" class="headerlink" title=""></a></h6><h2 id="四-补充注意点"><a href="#四-补充注意点" class="headerlink" title="四.补充注意点"></a>四.补充注意点</h2><h5 id="1-为什么要把所有静态资源（html文件，或者css之类）指定放置到与入口文件index-js同级的public文件夹下"><a href="#1-为什么要把所有静态资源（html文件，或者css之类）指定放置到与入口文件index-js同级的public文件夹下" class="headerlink" title="1.为什么要把所有静态资源（html文件，或者css之类）指定放置到与入口文件index.js同级的public文件夹下?"></a>1.为什么要把所有静态资源（html文件，或者css之类）指定放置到与入口文件index.js同级的public文件夹下?</h5><ul>
<li><p>要把所有静态资源（html文件，或者css之类）指定放置到与入口文件index.js同级的public文件夹下</p>
<ul>
<li><pre><code>index.js的app.use()函数也指定了public文件夹作为存放静态资源的路径。故sendFile()函数自动从public文件夹里寻找html
</code></pre>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&#x27;express&#x27;);</span><br><span class="line">var app = express();</span><br><span class="line">var path = require(&#x27;path&#x27;);</span><br><span class="line">//加载静态资源</span><br><span class="line">app.use(express.static(path.join(__dirname, &#x27;public&#x27;)));</span><br><span class="line"></span><br><span class="line">app.get(&#x27;/&#x27;, function(req, res) &#123;</span><br><span class="line">    res.sendFile(&#x27;/index.html&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line">app.listen(8080);</span><br></pre></td></tr></table></figure>

<ul>
<li>index.js在package.json中被指定为入口文件（相当于C语言的 main.cpp）&#x3D;&gt;不放在一个包实现方法</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&#x27;express&#x27;);</span><br><span class="line">var app = express();</span><br><span class="line">var path = require(&#x27;path&#x27;);</span><br><span class="line"></span><br><span class="line">//app.use(express.static(path.join(__dirname, &#x27;public&#x27;)));</span><br><span class="line"></span><br><span class="line">app.get(&#x27;/&#x27;, function(req, res) &#123;</span><br><span class="line">    //res.send(&#x27;hello!&#x27;);</span><br><span class="line">    res.sendFile(__dirname + &#x27;/index.html&#x27;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<p>​    </p>
<h6 id="2-新项目常用修改"><a href="#2-新项目常用修改" class="headerlink" title="2.新项目常用修改"></a>2.新项目常用修改</h6><p>​	二&#x3D;&gt;5,6,7</p>
<hr>
<h1 id="———————–-NODE贰-————————"><a href="#———————–-NODE贰-————————" class="headerlink" title="———————–&#x3D;&#x3D;(NODE贰)&#x3D;&#x3D;————————-"></a>———————–&#x3D;&#x3D;(NODE贰)&#x3D;&#x3D;————————-</h1><h1 id="请求req和响应原理resp（前后端传输简单示例）-Day7-17"><a href="#请求req和响应原理resp（前后端传输简单示例）-Day7-17" class="headerlink" title="请求req和响应原理resp（前后端传输简单示例）&#x3D;&gt;Day7_17"></a><strong>请求req和响应原理resp（前后端传输简单示例）&#x3D;&gt;Day7_17</strong></h1><h2 id="一-箭头函数和匿名函数区别-作用时间区别"><a href="#一-箭头函数和匿名函数区别-作用时间区别" class="headerlink" title="一.箭头函数和匿名函数区别(作用时间区别)"></a>一.箭头函数和匿名函数区别(作用时间区别)</h2><h5 id="1-正常情况下this指向window"><a href="#1-正常情况下this指向window" class="headerlink" title="1.正常情况下this指向window"></a>1.正常情况下this指向window</h5><h5 id="2-箭头函数是编译-解析-时"><a href="#2-箭头函数是编译-解析-时" class="headerlink" title="2.箭头函数是编译(解析)时&#x3D;&gt;"></a>2.箭头函数是编译(解析)时&#x3D;&gt;</h5><ul>
<li><pre><code>编译时指向当前this指向
</code></pre>
</li>
</ul>
<h5 id="3-匿名函数是进行-运行-时"><a href="#3-匿名函数是进行-运行-时" class="headerlink" title="3.匿名函数是进行(运行)时&#x3D;&gt;"></a>3.匿名函数是进行(运行)时&#x3D;&gt;</h5><ul>
<li>全局环境指向window   function</li>
</ul>
<h2 id="二-数据传输简单基础原理-服务端-浏览器-POST-GET"><a href="#二-数据传输简单基础原理-服务端-浏览器-POST-GET" class="headerlink" title="二.数据传输简单基础原理&#x3D;&gt;(服务端,浏览器,POST,GET)"></a>二.数据传输简单基础原理&#x3D;&gt;(服务端,浏览器,POST,GET)</h2><h5 id="1-浏览器访问原理"><a href="#1-浏览器访问原理" class="headerlink" title="1. 浏览器访问原理&#x3D;&gt;"></a>1. 浏览器访问原理&#x3D;&gt;</h5><ul>
<li>协议&#x3D;&gt;ip&#x3D;&gt;端口&#x3D;&gt;uri</li>
</ul>
<h5 id="2-服务端-前端-数据传输过程"><a href="#2-服务端-前端-数据传输过程" class="headerlink" title="2. 服务端(前端)数据传输过程&#x3D;&gt;"></a>2. 服务端(前端)数据传输过程&#x3D;&gt;</h5><ul>
<li>控制层&#x3D;&gt;逻辑层&#x3D;&gt;数据层&#x3D;&gt;后端(数据持久层)</li>
</ul>
<h5 id="3-GET与POST区别"><a href="#3-GET与POST区别" class="headerlink" title="3. GET与POST区别:&#x3D;&gt;"></a>3. GET与POST区别:&#x3D;&gt;</h5><ul>
<li>GET是进行明文传递,POST非明文请求数据放在请求体中</li>
</ul>
<h2 id="三-状态码大致意义"><a href="#三-状态码大致意义" class="headerlink" title="三.状态码大致意义"></a>三.状态码大致意义</h2><ul>
<li>4xx开头是客户端,</li>
<li>5xx开头服务端问题,</li>
<li>200 ok,</li>
<li>3开头 nginx请求转发</li>
</ul>
<h2 id="四-请求响应与跨域"><a href="#四-请求响应与跨域" class="headerlink" title="四.请求响应与跨域"></a>四.请求响应与跨域</h2><h5 id="1-req-request（请求对象）"><a href="#1-req-request（请求对象）" class="headerlink" title="1.req:request（请求对象）&#x3D;&gt;"></a>1.req:request（请求对象）&#x3D;&gt;</h5><ul>
<li><pre><code>代表,所有跟请求有关的东西都在req对象里头,包括请求参数 请求头 请求头 cookie
</code></pre>
</li>
</ul>
<h5 id="2-res-response（响应对象）"><a href="#2-res-response（响应对象）" class="headerlink" title="2.res:response（响应对象）&#x3D;&gt;"></a>2.res:response（响应对象）&#x3D;&gt;</h5><ul>
<li>所有响应客户端的东西都在res里头,包括相应参数,响应头(跨域处理就是在这)</li>
</ul>
<h5 id="3-跨域请求的本质与原理"><a href="#3-跨域请求的本质与原理" class="headerlink" title="3.跨域请求的本质与原理&#x3D;&gt;"></a>3.跨域请求的本质与原理&#x3D;&gt;</h5><ul>
<li><p>当一个请求url的协议、域名、端口三者之间任意一个与当前页面url不同即为跨域</p>
</li>
<li><p>请求本质是成功的,但是浏览器判断本次请求不安全</p>
</li>
</ul>
<h2 id="五-resp-send注意事项"><a href="#五-resp-send注意事项" class="headerlink" title="五.resp.send注意事项"></a>五.resp.send注意事项</h2><ol>
<li><h5 id="每个完整的请求-一定要以resp-send来结束请求-强调结束请求-而不是以resp-send结束代码"><a href="#每个完整的请求-一定要以resp-send来结束请求-强调结束请求-而不是以resp-send结束代码" class="headerlink" title="每个完整的请求,一定要以resp.send来结束请求,强调结束请求,而不是以resp.send结束代码"></a>每个完整的请求,一定要以resp.send来结束请求,强调结束请求,而不是以resp.send结束代码</h5></li>
<li><h5 id="如果请求结束了-也想让逻辑代码结束-那么一定要以return结束"><a href="#如果请求结束了-也想让逻辑代码结束-那么一定要以return结束" class="headerlink" title="如果请求结束了,也想让逻辑代码结束,那么一定要以return结束"></a>如果请求结束了,也想让逻辑代码结束,那么一定要以return结束</h5></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">let start=(req,resp)=&gt;&#123;</span><br><span class="line">    resp.send(req.query)</span><br><span class="line">    return;</span><br><span class="line">    console.log(111);&#125;</span><br></pre></td></tr></table></figure>

<h2 id="六-补充注意点"><a href="#六-补充注意点" class="headerlink" title="六.补充注意点"></a>六.补充注意点</h2><h5 id="1-JQ入口函数意义"><a href="#1-JQ入口函数意义" class="headerlink" title="1.JQ入口函数意义&#x3D;&gt;"></a>1.JQ入口函数意义&#x3D;&gt;</h5><ul>
<li><p>入口函数,通常使用和window.onload一样的功效</p>
</li>
<li><p>区别:在jquery文件加载后,同时当前的window下面已经有了$和jq对象后,才开始运行</p>
</li>
</ul>
<hr>
<h1 id="———————–-NODE叁-————————"><a href="#———————–-NODE叁-————————" class="headerlink" title="———————–&#x3D;&#x3D;(NODE叁)&#x3D;&#x3D;————————-"></a>———————–&#x3D;&#x3D;(NODE叁)&#x3D;&#x3D;————————-</h1><h1 id="Cookie、session、图片验证码、jwt的使用-Day7-20-21"><a href="#Cookie、session、图片验证码、jwt的使用-Day7-20-21" class="headerlink" title="Cookie、session、图片验证码、jwt的使用&#x3D;&gt;Day7_20~21"></a>Cookie、session、图片验证码、jwt的使用&#x3D;&gt;Day7_20~21</h1><h2 id="一-response-cookie和request-cookie的区别"><a href="#一-response-cookie和request-cookie的区别" class="headerlink" title="一.response.cookie和request.cookie的区别"></a>一.response.cookie和request.cookie的区别</h2><h5 id="1-范围特点使用语法各不相同"><a href="#1-范围特点使用语法各不相同" class="headerlink" title="1.范围特点使用语法各不相同"></a>1.范围特点使用语法各不相同</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.cookie：</span><br></pre></td></tr></table></figure>

<ol>
<li><p>操作过的Cookie，所有方法获取到的都是被更新过的值，也就是说Response.Cookies是修改所有容器中的Cookie的值。   </p>
</li>
<li><p>用于在客户端写入cookie值。若指定的cookie不存在，则创建它。若存在，则将自动进行更新。结果返回给客户端浏览器。   </p>
</li>
<li><p>Response.Cookies(CookieName)[(key)|.attribute]&#x3D;value。这里的CookiesName是指定的Cookie的名称，如果指定了Key，则该Cookie就是一个字典，Attribute属性包括Domain，Expires，HasKeys，Path，Secure。</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.cookie：</span><br></pre></td></tr></table></figure>

<ol>
<li>创建的Cookie只能用于后台不能用于HTML的前台。</li>
<li>设置cookie的最大有效期为30天，然后通过Response回送cookie到浏览器。</li>
<li>Request.Cookies使用语法：Request.Cookies(cookie)[(key)|.attribute]。</li>
</ol>
<h2 id="二-Cookie代码示范"><a href="#二-Cookie代码示范" class="headerlink" title="二.Cookie代码示范"></a>二.Cookie代码示范</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 设置cookie</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setCookie</span>(<span class="params">name, value, seconds</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;进入setCookie逻辑函数&#x27;</span>)</span><br><span class="line">    seconds = seconds || <span class="number">0</span>;   <span class="comment">//conds有值就直接赋值，没有为0，这个根php不一样。</span></span><br><span class="line">    <span class="keyword">var</span> expires = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="comment">// cookies随浏览器关闭而失效的方法:</span></span><br><span class="line">    <span class="comment">//     如果不设置Expires的属性那么Cookie的存活时间就是在关闭浏览器的时候。</span></span><br><span class="line">    <span class="keyword">if</span> (seconds != <span class="number">0</span> ) &#123;      <span class="comment">//设置cookie生存时间</span></span><br><span class="line">        <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        date.<span class="title function_">setTime</span>(date.<span class="title function_">getTime</span>()+(seconds*<span class="number">1000</span>));</span><br><span class="line">        expires = <span class="string">&quot;; expires=&quot;</span>+date.<span class="title function_">toGMTString</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">cookie</span> = name+<span class="string">&quot;=&quot;</span>+<span class="built_in">escape</span>(value)+expires+<span class="string">&quot;; path=/&quot;</span>;   <span class="comment">//转码并赋值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 读取cookie</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getCookie</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;进入getCookie逻辑函数&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> nameEQ = name + <span class="string">&#x27;=&#x27;</span></span><br><span class="line">    <span class="keyword">var</span> ca = <span class="variable language_">document</span>.<span class="property">cookie</span>.<span class="title function_">split</span>(<span class="string">&#x27;;&#x27;</span>) <span class="comment">// 把cookie分割成组</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; ca.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> c = ca[i] <span class="comment">// 取得字符串</span></span><br><span class="line">        <span class="keyword">while</span> (c.<span class="title function_">charAt</span>(<span class="number">0</span>) == <span class="string">&#x27; &#x27;</span>) &#123; <span class="comment">// 判断一下字符串有没有前导空格</span></span><br><span class="line">            c = c.<span class="title function_">substring</span>(<span class="number">1</span>, c.<span class="property">length</span>) <span class="comment">// 有的话，从第二位开始取</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (c.<span class="title function_">indexOf</span>(nameEQ) == <span class="number">0</span>) &#123; <span class="comment">// 如果含有我们要的name</span></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">unescape</span>(c.<span class="title function_">substring</span>(nameEQ.<span class="property">length</span>, c.<span class="property">length</span>)) <span class="comment">// 解码并截取我们要值</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查cookie</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">c_name</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">boolean</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkCookie</span>(<span class="params">c_name</span>) &#123;</span><br><span class="line">    username = <span class="title function_">getCookie</span>(c_name);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(username);</span><br><span class="line">    <span class="keyword">if</span> (username != <span class="literal">null</span> &amp;&amp; username != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 清除cookie</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">name</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clearCookie</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="title function_">setCookie</span>(name, <span class="string">&quot;&quot;</span>, -<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="三-Cookie生命周期"><a href="#三-Cookie生命周期" class="headerlink" title="三.Cookie生命周期"></a>三.Cookie生命周期</h2><p>如果要立马失效时间要设置为-1,设置为0为本次浏览器关闭结束生命周期</p>
<p>  如果不设置Expires的属性那么Cookie的存活时间就是在关闭浏览器的时候。</p>
<h2 id="四-session使用"><a href="#四-session使用" class="headerlink" title="四.session使用"></a>四.session使用</h2><h6 id="1-session的概念"><a href="#1-session的概念" class="headerlink" title="1.session的概念&#x3D;&gt;"></a>1.session的概念&#x3D;&gt;</h6><p>​			会话（生命周期：通常是浏览器关了，session就没了，不同的浏览器有不同的session，永久不冲突）</p>
<h6 id="2-session的应用–》"><a href="#2-session的应用–》" class="headerlink" title="2.session的应用–》"></a>2.session的应用–》</h6><p>​			用来存储会话级别的变量：令牌的解密秘钥等，当前登录的用户的信息（可以给数据拾释压）</p>
<h6 id="3-session的使用–》区别于之前我们使用cookie的用法"><a href="#3-session的使用–》区别于之前我们使用cookie的用法" class="headerlink" title="3.session的使用–》区别于之前我们使用cookie的用法:"></a>3.session的使用–》区别于之前我们使用cookie的用法:</h6><ol>
<li><h6 id="cookie的用法：前后端共享的变量区域"><a href="#cookie的用法：前后端共享的变量区域" class="headerlink" title="cookie的用法：前后端共享的变量区域"></a>cookie的用法：前后端共享的变量区域</h6><ol>
<li>获取cookie:由请求对象来实现<br>                                  2.  操作cookie：包括增删改 由响应对象来实现<br><br>    2. ###### session的用法：只能服务端操作，仅仅是存在在服务端<br><br>        1.  获取由请求对象来获取<br>        2.  操作由请求对象来操作</li>
</ol>
</li>
</ol>
<p>​         </p>
<h6 id="4-原理解答"><a href="#4-原理解答" class="headerlink" title="4.原理解答&#x3D;&gt;"></a>4.原理解答&#x3D;&gt;</h6><p>就是当访问一个页面的时候给浏览器创建一个独一无二的号码，也给同时创建的session赋予同样的号码。这样就可以在打开同一个网站的第二个页面时获取到第一个页面中session保留下来的对应信息（理解：当访问第二个页面时将号码同时传递到第二个页面。找到对应的session。）。这个号码也叫sessionID，session的ID号码，session的独一无二号码。</p>
<h6 id="5-session安装语句"><a href="#5-session安装语句" class="headerlink" title="5.session安装语句"></a>5.session安装语句</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express-session</span><br></pre></td></tr></table></figure>

<h6 id="6-配置中间件-app-js"><a href="#6-配置中间件-app-js" class="headerlink" title="6.配置中间件&#x3D;&gt;app.js"></a>6.配置中间件&#x3D;&gt;app.js</h6><p>注意 :设置在var app &#x3D; express();之后,路由之前</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置在var app = express();之后</span></span><br><span class="line"><span class="comment">//引入session</span></span><br><span class="line"><span class="keyword">const</span> session=<span class="built_in">require</span>(<span class="string">&#x27;express-session&#x27;</span>)</span><br><span class="line"><span class="comment">//配置中间件 maxAge单位为ms</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">    <span class="attr">secret</span>: <span class="string">&quot;keyboard cat&quot;</span>,</span><br><span class="line">    <span class="attr">resave</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">saveUninitialized</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">//maxAge:最多可以存活多久</span></span><br><span class="line">    <span class="attr">cookie</span>: (<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;value&#x27;</span>,&#123;<span class="attr">maxAge</span>:  <span class="number">5</span>*<span class="number">60</span>*<span class="number">1000</span>,<span class="attr">secure</span>: <span class="literal">false</span>&#125;)</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>

<h6 id="7-express-session使用"><a href="#7-express-session使用" class="headerlink" title="7.express-session使用"></a>7.express-session使用</h6><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置session</span></span><br><span class="line">req.<span class="property">session</span>.<span class="property">username</span>=<span class="string">&quot;张三&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//获取session</span></span><br><span class="line">req.<span class="property">session</span>.<span class="property">username</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//重新设置cookie的过期时间为1s</span></span><br><span class="line">req.<span class="property">session</span>.<span class="property">cookie</span>.<span class="property">maxAge</span>=<span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//销毁session</span></span><br><span class="line">req.<span class="property">session</span>.<span class="title function_">destroy</span>(<span class="keyword">function</span>(<span class="params">err</span>)&#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="五-图片验证码实现"><a href="#五-图片验证码实现" class="headerlink" title="五.图片验证码实现"></a>五.图片验证码实现</h2><h6 id="1-svg安装"><a href="#1-svg安装" class="headerlink" title="1.svg安装"></a>1.svg安装</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install svg-captcha</span><br></pre></td></tr></table></figure>

<h6 id="2-图片验证码代码"><a href="#2-图片验证码代码" class="headerlink" title="2.图片验证码代码"></a>2.图片验证码代码</h6><p>①前端页面代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">fieldset</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">legend</span>&gt;</span>验证码</span><br><span class="line">    <span class="tag">&lt;/<span class="name">legend</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://localhost:3000/users/getCaptcha&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span>  <span class="attr">id</span>=<span class="string">&quot;capText&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;captachaValid()&quot;</span>&gt;</span>验证<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>②运行函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">captachaValid</span>(<span class="params"></span>)&#123;</span><br><span class="line">    future.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>:<span class="string">&#x27;/users/captachaValid&#x27;</span>,</span><br><span class="line">        <span class="attr">type</span>:<span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">        <span class="attr">data</span>:&#123;</span><br><span class="line">            <span class="attr">captcha</span>:$(<span class="string">&#x27;#capText&#x27;</span>).<span class="title function_">val</span>()</span><br><span class="line">        &#125;,<span class="attr">success</span>:<span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&#x27;验证成功&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>③路由文件中(routes&#x2F;users)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> svgCaptcha = <span class="built_in">require</span>(<span class="string">&#x27;svg-captcha&#x27;</span>);</span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/getCaptcha&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> captcha = svgCaptcha.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="comment">// 翻转颜色</span></span><br><span class="line">    <span class="attr">inverse</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// 字体大小</span></span><br><span class="line">    <span class="attr">fontSize</span>: <span class="number">36</span>,</span><br><span class="line">    <span class="comment">// 噪声线条数</span></span><br><span class="line">    <span class="attr">noise</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="comment">// 宽度</span></span><br><span class="line">    <span class="attr">width</span>: <span class="number">80</span>,</span><br><span class="line">    <span class="comment">// 高度</span></span><br><span class="line">    <span class="attr">height</span>: <span class="number">30</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 保存到session,忽略大小写</span></span><br><span class="line">  req.<span class="property">session</span>.<span class="property">captcha</span> = captcha.<span class="property">text</span>.<span class="title function_">toLowerCase</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">session</span>.<span class="property">captcha</span>); <span class="comment">//0xtg 生成的验证码</span></span><br><span class="line">  <span class="comment">//设置什么格式返回前端,默认text格式</span></span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;image/svg+xml&#x27;</span>);</span><br><span class="line">  <span class="comment">//将此数据转成字符串写入传到前端,并且.write并不会结束请求可以多次调用</span></span><br><span class="line">  res.<span class="title function_">write</span>(<span class="title class_">String</span>(captcha.<span class="property">data</span>));</span><br><span class="line">  res.<span class="title function_">end</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h6 id="3-验证码使用实操"><a href="#3-验证码使用实操" class="headerlink" title="3.验证码使用实操"></a>3.验证码使用实操</h6><ol>
<li><p>安装npm install svg-captcha</p>
</li>
<li><p>直接使用captcha的api</p>
</li>
<li><p>直接根据captcha生成的对象做解析</p>
</li>
<li><p>幅度段返回验证码之前需要缓存验证码的内容(共后续验证用)</p>
</li>
<li><p>完成验证码的点击刷新功能</p>
 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://192.168.0.151:3000/users/getCaptcha&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;javascript:this.setAttribute(&#x27;src&#x27;,&#x27;http://192.168.0.151:3000/users/getCaptcha?v=&#x27;+new Date().getTime())&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据token不同生成不同验证码</span></span><br><span class="line">obj.<span class="title function_">setAttribute</span>(<span class="string">&#x27;src&#x27;</span>,<span class="string">&#x27;http://localhost:3000/users/getCaptcha?v=&#x27;</span>+<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>()+<span class="string">&quot;&amp;token=&quot;</span>+<span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="property">token</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="六-拦截器-jwt"><a href="#六-拦截器-jwt" class="headerlink" title="六.拦截器&#x3D;&gt;jwt"></a>六.拦截器&#x3D;&gt;jwt</h2><h5 id="1-jwt安装"><a href="#1-jwt安装" class="headerlink" title="1.jwt安装"></a>1.jwt安装</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install jsonwebtoken</span><br></pre></td></tr></table></figure>

<h5 id="2-jwt的相关api"><a href="#2-jwt的相关api" class="headerlink" title="2.jwt的相关api&#x3D;&gt;"></a>2.jwt的相关api&#x3D;&gt;</h5><h6 id="a-jwtUtils"><a href="#a-jwtUtils" class="headerlink" title="a.jwtUtils"></a>a.jwtUtils</h6><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 安全拦截器</span></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&quot;jsonwebtoken&quot;</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 验证权限</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">token</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> secretkey 秘钥</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">success</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">error</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">verify</span>(<span class="params">token, secretkey, success, error</span>) &#123;</span><br><span class="line">    jwt.<span class="title function_">verify</span>(token, secretkey, <span class="keyword">function</span> (<span class="params">err, decode</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="keyword">if</span> (error) &#123;</span><br><span class="line">                <span class="title function_">error</span>(err);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (success) &#123;</span><br><span class="line">                <span class="title function_">success</span>(decode);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 签名</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> load 载荷 json对象 存储存在</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> secretkey 秘钥</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> expiresIn 过期时间 秒</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">number | PromiseLike&lt;ArrayBuffer&gt;</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sign</span>(<span class="params">load, secretkey, expiresIn</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> token = jwt.<span class="title function_">sign</span>(load, secretkey, &#123;<span class="attr">expiresIn</span>: expiresIn&#125;);</span><br><span class="line">    <span class="keyword">return</span> token;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**异步转同步</span></span><br><span class="line"><span class="comment"> * 这个再app.js路由调用中已经转换过一次,所以不用重复转换</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">token</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">secretkey</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">Promise&lt;any&gt;</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">verifysync</span>(<span class="params">token, secretkey</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        jwt.<span class="title function_">verify</span>(token, secretkey, <span class="keyword">function</span> (<span class="params">err, decode</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>);</span><br><span class="line">                    <span class="title function_">resolve</span>(&#123;<span class="attr">err</span>: <span class="string">&#x27;error&#x27;</span>, <span class="attr">msg</span>: <span class="string">&#x27;绘画已过期&#x27;</span>&#125;)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="title function_">resolve</span>(decode)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;verify, sign, verifysync&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*//使用解密</span></span><br><span class="line"><span class="comment">let user=&#123;id:111,name:&#x27;user&#x27;,password:123456&#125;;</span></span><br><span class="line"><span class="comment">/!*</span></span><br><span class="line"><span class="comment">//q清空密码</span></span><br><span class="line"><span class="comment">delete user.password;</span></span><br><span class="line"><span class="comment">let token=sign(user,&#x27;123456&#x27;,10);*!/</span></span><br><span class="line"><span class="comment">//解密</span></span><br><span class="line"><span class="comment">let token=sign(user,&#x27;123456&#x27;,10);</span></span><br><span class="line"><span class="comment">verify(token,&quot;123456&quot;,function (user) &#123;</span></span><br><span class="line"><span class="comment">    console.log(user);</span></span><br><span class="line"><span class="comment">&#125;,function (err) &#123;</span></span><br><span class="line"><span class="comment">    console.error(err)</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">)</span></span><br><span class="line"><span class="comment">console.log(token);*/</span></span><br><span class="line"><span class="comment">/*verify(token,&#x27;123456&#x27;,function (user) &#123;</span></span><br><span class="line"><span class="comment">    console.log(user)</span></span><br><span class="line"><span class="comment">&#125;,function (err) &#123;</span></span><br><span class="line"><span class="comment">    console.error(err);</span></span><br><span class="line"><span class="comment">&#125;)*/</span></span><br></pre></td></tr></table></figure>

<h6 id="b-拦截器中间件"><a href="#b-拦截器中间件" class="headerlink" title="b.拦截器中间件&#x3D;&gt;"></a>b.拦截器中间件&#x3D;&gt;</h6><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//拦截器中间件,原本</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span>(<span class="params">req,resp,next</span>)&#123;</span><br><span class="line">    log.<span class="title function_">debug</span>(req.<span class="property">path</span>);</span><br><span class="line">    <span class="keyword">if</span>(req.<span class="property">path</span> !=<span class="string">&#x27;/mine.html&#x27;</span> &amp;&amp; req.<span class="property">path</span> !=<span class="string">&#x27;/user/login&#x27;</span> &amp;&amp; req.<span class="property">path</span> !=<span class="string">&#x27;/user/register&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> token = req.<span class="property">headers</span>.<span class="property">token</span>;</span><br><span class="line">        safeInterceptor.<span class="title function_">verify</span>(token,<span class="variable language_">global</span>.<span class="property">secretKey</span>,<span class="keyword">function</span>(<span class="params">user</span>)&#123;</span><br><span class="line">            req.<span class="property">headers</span>.<span class="property">sessionData</span> = user;</span><br><span class="line">            <span class="title function_">next</span>();</span><br><span class="line">        &#125;,<span class="keyword">function</span>(<span class="params">err</span>)&#123;</span><br><span class="line">            <span class="title function_">next</span>();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_">next</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 全系统允许跨域处理 这段配置要再new出express实例的时候就要设置了，放在所有的api前面，不然没有效果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&quot;*&quot;</span>,<span class="keyword">function</span>(<span class="params">req,res,next</span>)&#123;</span><br><span class="line">    <span class="comment">//设置允许跨域的域名，*代表允许任意域名跨域</span></span><br><span class="line">    res.<span class="title function_">header</span>(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>,<span class="string">&quot;*&quot;</span>);</span><br><span class="line">    <span class="comment">//允许的header类型</span></span><br><span class="line">    res.<span class="title function_">header</span>(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>,<span class="string">&quot;*&quot;</span>);</span><br><span class="line">    <span class="comment">//跨域允许的请求方式</span></span><br><span class="line">    res.<span class="title function_">header</span>(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>,<span class="string">&quot;*&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span>.<span class="title function_">toLowerCase</span>() == <span class="string">&#x27;options&#x27;</span>)</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="number">200</span>);  <span class="comment">//让options尝试请求快速结束</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="title function_">next</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 拦截器中间件,登陆注册功能时修改使用的</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">async</span> <span class="keyword">function</span>(<span class="params">req,resp,next</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> path =req.<span class="property">path</span>;</span><br><span class="line">    <span class="comment">//检查路由 决定是否拦截,``````````~~~~~~~~!!!!!犯的错误:将除了登陆外的全部拦截了</span></span><br><span class="line">    <span class="keyword">if</span> (path.<span class="title function_">startsWith</span>(<span class="string">&#x27;/users/login&#x27;</span>)||path.<span class="title function_">startsWith</span>(<span class="string">&#x27;/user&#x27;</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;登入页面放行&quot;</span>)</span><br><span class="line">        <span class="title function_">next</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//从请求头里面拿到令牌==&gt;常规方法</span></span><br><span class="line">        <span class="keyword">let</span> token =req.<span class="property">headers</span>.<span class="property">token</span>;</span><br><span class="line">        <span class="keyword">if</span>(!token)&#123;</span><br><span class="line">            <span class="comment">//非常规状况(文件下载,是否没办法设置请求头,或者例如获取验证码等)</span></span><br><span class="line">            token=req.<span class="property">query</span>.<span class="property">token</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> result=<span class="keyword">await</span> jwtUtils.<span class="title function_">verifysync</span>(token,<span class="variable language_">global</span>.<span class="property">globalKey</span>)</span><br><span class="line">        <span class="keyword">if</span> (result.<span class="property">err</span>) &#123;</span><br><span class="line">            <span class="comment">// resp.status(500)</span></span><br><span class="line">            resp.<span class="title function_">send</span>(result.<span class="property">msg</span>)</span><br><span class="line">            <span class="comment">// throw  new Error(result.msg)</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            req.<span class="property">headers</span>.<span class="property">session</span>=result;</span><br><span class="line">            <span class="comment">//表示执行下一步动作--&gt;放行</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;成公了&quot;</span>)</span><br><span class="line">            <span class="title function_">next</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-前后端分离的场景"><a href="#3-前后端分离的场景" class="headerlink" title="3.前后端分离的场景&#x3D;&gt;"></a>3.前后端分离的场景&#x3D;&gt;</h5><p>当前用户的身份如果以明文传输,很容易故意被模仿,所以 需要对用户的身份进行加密传输<br>          加密传输的方式:<br>                        1)https<br>                        2)rsa 非对称加密<br>                        3)aes 对称密钥<br>                        4)jwt json web token: 目前比较流行的</p>
<h5 id="4-jwt的作用"><a href="#4-jwt的作用" class="headerlink" title="4.jwt的作用&#x3D;&gt;"></a>4.jwt的作用&#x3D;&gt;</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">用来加密门票用的.</span><br><span class="line">加密:1)被加密 2)用什么加密(加盐)</span><br><span class="line">简单版的:密钥共用,但是被加密的东西不一样</span><br></pre></td></tr></table></figure>

<h5 id="5-实际操作"><a href="#5-实际操作" class="headerlink" title="5.实际操作&#x3D;&gt;"></a>5.实际操作&#x3D;&gt;</h5><ol>
<li>在用户登录成功之后使用jwt对用户的基本信息进行加密(注意要提出密码属性)</li>
<li>加密之后,将token返回到前端,存储到localStorage</li>
<li>每次请求,在请求发送之前,将localStorage里头的令牌,当作请求头一起发送</li>
<li>服务端针对需要验权(鉴权)的api进行定制化拦截(前置拦截器)</li>
<li>将拦截下来的req里头的令牌取出来,并做解密错做<ol>
<li><pre><code> 解密成功:将解密出来的对象,即用户的基本信息对象,并将该基本信息对象存到请求头里去(单线程变量-用时间换空间)
</code></pre>
</li>
<li><pre><code> 解密失败:请求结束并报错(会话已经过期,请重新登录,前端的表现通常时直接重定向到登录页面)
</code></pre>
</li>
</ol>
</li>
<li>执行业务代码,如果执行的过程需要用到用户信息,那么不要再从数据库里头去查询数据,直接从请求捞就行了</li>
</ol>
<h1 id="———————-问题与解决一-——————–"><a href="#———————-问题与解决一-——————–" class="headerlink" title="———————&#x3D;&#x3D;(问题与解决一)&#x3D;&#x3D;——————–"></a>———————&#x3D;&#x3D;(问题与解决一)&#x3D;&#x3D;——————–</h1><h1 id="遇到的问题与解决方法"><a href="#遇到的问题与解决方法" class="headerlink" title="遇到的问题与解决方法&#x3D;&gt;:"></a>遇到的问题与解决方法&#x3D;&gt;:</h1><h5 id="1-为何在字符串中转义不出变量"><a href="#1-为何在字符串中转义不出变量" class="headerlink" title="1.为何在字符串中转义不出变量"></a>1.为何在字符串中转义不出变量</h5><p>​	问题代码位置&#x3D;&gt;console.log(‘会话ID:${req.sessionID}’);&#x3D;&gt;test&#x2F;users.js&#x3D;&gt;26  </p>
<p>​	问题分析&#x3D;&gt;用错符号,应用模板符号</p>
<p>​	问题解决&#x3D;&gt;使用&#96;&#96;而不能用’’</p>
<h5 id="2-为什么在后台代码test-users中调用不了public中的自定义-CookieUti-js-js包中的函数"><a href="#2-为什么在后台代码test-users中调用不了public中的自定义-CookieUti-js-js包中的函数" class="headerlink" title="2.为什么在后台代码test&#x2F;users中调用不了public中的自定义(CookieUti.js)js包中的函数?"></a>2.为什么在后台代码test&#x2F;users中调用不了public中的自定义(CookieUti.js)js包中的函数?</h5><p>​	问题代码位置&#x3D;&gt;test&#x2F;users.js&#x3D;&gt;35</p>
<p>​	问题分析&#x3D;&gt;在后台代码test&#x2F;users中调用静态资源中的文件,导致调用错误</p>
<p>​    原理剖析&#x3D;&gt;本质上node是后台代码,其中包括bin&#x2F;www , routes&#x2F;users.js||index.js ,node_modules  ,app.js , </p>
<p>​						package.json都是后台文件, 而public其实是单独的静态文件,它与后台文件是通过共享port端口进行数								据传输,而不能相互调用</p>
<p>​						</p>
<hr>
<hr>
<h1 id="———————–-NODE肆-————————"><a href="#———————–-NODE肆-————————" class="headerlink" title="———————–&#x3D;&#x3D;(NODE肆)&#x3D;&#x3D;————————-"></a>———————–&#x3D;&#x3D;(NODE肆)&#x3D;&#x3D;————————-</h1><h1 id="基于对7-20-21知识点的复习与补充-md-day7-22-23"><a href="#基于对7-20-21知识点的复习与补充-md-day7-22-23" class="headerlink" title="基于对7_20~21知识点的复习与补充.md&#x3D;&gt;day7_22-23"></a>基于对7_20~21知识点的复习与补充.md&#x3D;&gt;day7_22-23</h1><h2 id="一-对于一个新项目实操准备工作"><a href="#一-对于一个新项目实操准备工作" class="headerlink" title="一.对于一个新项目实操准备工作"></a>一.对于一个新项目实操准备工作</h2><h6 id="1、重新配置app-js"><a href="#1、重新配置app-js" class="headerlink" title="1、重新配置app.js"></a>1、重新配置app.js</h6><ol>
<li><p>配置全局异常处理拦截器（后置拦截器）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> res.status(err.status || 500);</span><br><span class="line">/*</span><br><span class="line">*  ①配置全局异常处理拦截器(后置拦截器)</span><br><span class="line">* */</span><br><span class="line"> res.render(err.message);</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置全局请求拦截器（前置拦截器）–后面一起讲（jwt）</p>
</li>
</ol>
<h6 id="2、基于public构建同域前端"><a href="#2、基于public构建同域前端" class="headerlink" title="2、基于public构建同域前端"></a>2、基于public构建同域前端</h6><ol>
<li>public作为静态的目录文件夹是可以配置的</li>
<li>静态目录里头的文件和服务端的文件是要区分开来的，不具备相互引用的能力<ol>
<li>静态目录里头的文件最终都是在客户端被访问</li>
<li>服务端里头的文件只提供服务，不提供文件的访问</li>
<li>静态文件和服务端的文件之间的交互要通过http请求来实现（ajax fetch axios）</li>
</ol>
</li>
</ol>
<h6 id="3-使用session"><a href="#3-使用session" class="headerlink" title="3. 使用session"></a>3. 使用session</h6><p>​		使用express-session来操作服务端的session</p>
<p>​		安装：npm install express-session</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/*引用session</span><br><span class="line">* */</span><br><span class="line">let session=require(&#x27;express-session&#x27;)</span><br><span class="line">/*</span><br><span class="line">*session配置</span><br><span class="line">* */</span><br><span class="line">app.use(session(&#123;</span><br><span class="line">    secret:&quot;keyboard cat&quot;</span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>

<h6 id="4-验证码"><a href="#4-验证码" class="headerlink" title="4. 验证码"></a>4. 验证码</h6><ol>
<li><p>① 安装</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install svg-captcha</span><br></pre></td></tr></table></figure>
</li>
<li><p>直接使用captcha的api</p>
</li>
<li><p>直接根据captcha生成的对象做解析</p>
</li>
<li><p>幅度段返回验证码之前需要缓存验证码的内容(共后续验证用)</p>
</li>
<li><p>完成验证码的点击刷新功能</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//  &lt;img src=&quot;http://192.168.0.151:3000/users/getCaptcha&quot; onclick=&quot;javascript:this.setAttribute(&#x27;src&#x27;,&#x27;http://192.168.0.151:3000/users/getCaptcha?v=&#x27;+new Date().getTime())&quot;&gt;</span><br></pre></td></tr></table></figure>

<h2 id="二-重要准则"><a href="#二-重要准则" class="headerlink" title="二.重要准则"></a>二.重要准则</h2><h6 id="1-很重要的准则："><a href="#1-很重要的准则：" class="headerlink" title="1.很重要的准则："></a>1.很重要的准则：</h6><ol>
<li>指令可以也应该要全局安装</li>
<li>依赖通常是装在局部，（没办法确保项目和全局的目录是一个侄子和叔叔的关系）</li>
</ol>
<h6 id="2-require引用包的一个次序。"><a href="#2-require引用包的一个次序。" class="headerlink" title="2.require引用包的一个次序。"></a>2.require引用包的一个次序。</h6><ol>
<li>主要理解 省略后缀名的场景和 node_modules找包的一个次序（从里往外）</li>
</ol>
<p>​	</p>
<p>​	</p>
<hr>
<h1 id="———————–-NODE伍-————————"><a href="#———————–-NODE伍-————————" class="headerlink" title="———————–&#x3D;&#x3D;(NODE伍)&#x3D;&#x3D;————————-"></a>———————–&#x3D;&#x3D;(NODE伍)&#x3D;&#x3D;————————-</h1><h1 id="Promise-await-async概念及简单应用-Day7-23"><a href="#Promise-await-async概念及简单应用-Day7-23" class="headerlink" title="Promise+await+async概念及简单应用&#x3D;&gt;Day7_23"></a>Promise+await+async概念及简单应用&#x3D;&gt;Day7_23</h1><h2 id="一-Promise"><a href="#一-Promise" class="headerlink" title="一.Promise"></a>一.Promise</h2><h5 id="1-Promise作用"><a href="#1-Promise作用" class="headerlink" title="1.Promise作用:"></a>1.Promise作用:</h5><blockquote>
<h6 id="用来解决回调地狱问题，但是只是简单的改变格式，并没有彻底解决上面的问题真正要解决上述问题，一定要利用promise再加上await和async关键字实现异步传同步"><a href="#用来解决回调地狱问题，但是只是简单的改变格式，并没有彻底解决上面的问题真正要解决上述问题，一定要利用promise再加上await和async关键字实现异步传同步" class="headerlink" title="用来解决回调地狱问题，但是只是简单的改变格式，并没有彻底解决上面的问题真正要解决上述问题，一定要利用promise再加上await和async关键字实现异步传同步"></a>用来解决回调地狱问题，但是只是简单的改变格式，并没有彻底解决上面的问题真正要解决上述问题，一定要利用promise再加上await和async关键字实现异步传同步</h6></blockquote>
<h5 id="2-Promise运行"><a href="#2-Promise运行" class="headerlink" title="2.Promise运行&#x3D;&gt;"></a>2.Promise运行&#x3D;&gt;</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//new的时候方法体就立刻运行</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve,reject</span>)&#123;<span class="comment">//业务代码&#125;）</span></span><br></pre></td></tr></table></figure>

<h5 id="3-Promise的参数解释"><a href="#3-Promise的参数解释" class="headerlink" title="3.Promise的参数解释&#x3D;&gt;"></a>3.Promise的参数解释&#x3D;&gt;</h5><ol>
<li><p>resolve:表示方法体里头执行成功之后的回调函数</p>
</li>
<li><p>reject:表示方法体里头出错后的回调函数</p>
</li>
<li><p>Function(函数):支持多层嵌套的回调函数作为方法体内容</p>
</li>
</ol>
<h5 id="-1"><a href="#-1" class="headerlink" title=""></a></h5><h2 id="二-Promise-await-async"><a href="#二-Promise-await-async" class="headerlink" title="二.Promise+await+async&#x3D;&gt;"></a>二.Promise+await+async&#x3D;&gt;</h2><h5 id="1-Promise-异步"><a href="#1-Promise-异步" class="headerlink" title="1)Promise&#x3D;&#x3D;&gt;异步"></a>1)Promise&#x3D;&#x3D;&gt;异步</h5><h5 id="2-await-异步转同步"><a href="#2-await-异步转同步" class="headerlink" title="2)await&#x3D;&#x3D;&gt;异步转同步"></a>2)await&#x3D;&#x3D;&gt;异步转同步</h5><p>​			1.await 可以理解为是 async wait 的简写。await 必须出现在 async 函数内部，不能单独使用。</p>
<p>​			2.await 后面可以跟任何的JS 表达式。虽然说 await 可以等很多类型的东西，但是它最主要的意图是用来等待 						Promise 对象的状态被 resolved。如果await的是 promise对象会造成异步函数停止执行并且等待 promise 的						解决,如果等的是正常的表达式则立即执行。</p>
<h5 id="3-async-同步转异步"><a href="#3-async-同步转异步" class="headerlink" title="3)async&#x3D;&#x3D;&gt;同步转异步"></a>3)async&#x3D;&#x3D;&gt;同步转异步</h5><ol>
<li>方法体内部的某个表达式使用await修饰，那么这个方法体所属方法必须要用async修饰所以使用awit方法会自动升级为异步方法</li>
</ol>
<h1 id="———————–-NODE陆-————————"><a href="#———————–-NODE陆-————————" class="headerlink" title="———————–&#x3D;&#x3D;(NODE陆)&#x3D;&#x3D;————————"></a>———————–&#x3D;&#x3D;(NODE陆)&#x3D;&#x3D;————————</h1><h1 id="Redis-Mysql数据库安装以及使用-Day-7-25"><a href="#Redis-Mysql数据库安装以及使用-Day-7-25" class="headerlink" title="Redis+Mysql数据库安装以及使用 &#x3D;&gt;Day_7_25"></a>Redis+Mysql数据库安装以及使用 &#x3D;&gt;Day_7_25</h1><h2 id="一-Redis-远程字典服务"><a href="#一-Redis-远程字典服务" class="headerlink" title="一.Redis(远程字典服务)"></a>一.Redis(远程字典服务)</h2><h3 id="1-Redis的特点"><a href="#1-Redis的特点" class="headerlink" title="1.Redis的特点:"></a>1.Redis的特点:</h3><p>1)工作的时候用的是以内存作为储存媒介,支持持久化</p>
<h3 id="2-Redis的优点"><a href="#2-Redis的优点" class="headerlink" title="2.Redis的优点:"></a>2.Redis的优点:</h3><h6 id="1-速度快"><a href="#1-速度快" class="headerlink" title="1.速度快"></a>1.速度快</h6><blockquote>
<p>   ​	(1) 因为数据存在内存中，类似于 HashMap ，HashMap 的优势就是查找和操作的时间复杂度都是O (1) 。<br>   (2) Redis 本质上是一个 Key-Value 类型的内存数据库，很像Memcached ，整个数据库统统加载在内存当中进行操作，定期通过<strong>异步操作</strong>把数据库数据 flush 到硬盘上进行保存。fork子进程持久化。<br>   (3) 因为是纯内存操作，Redis 的性能非常出色，每秒可以处理超过 10 万次读写操作，是已知性能最快的 Key-Value 数据库。</p>
</blockquote>
<h6 id="2-支持丰富数据类型-String-，List，Set，Sorted-Set，Hash-。"><a href="#2-支持丰富数据类型-String-，List，Set，Sorted-Set，Hash-。" class="headerlink" title="2.支持丰富数据类型: String ，List，Set，Sorted Set，Hash 。"></a>2.支持丰富数据类型: String ，List，Set，Sorted Set，Hash 。</h6><blockquote>
<p>   Redis 的出色之处不仅仅是性能，Redis 最大的魅力是支持保存多种数据结构，此外单个 Value 的最大限制是1GB，不像 Memcached只能保存1MB的数据，因此Redis可以用来实现很多有用的功能</p>
</blockquote>
<h6 id="3-丰富的特性"><a href="#3-丰富的特性" class="headerlink" title="3.丰富的特性"></a>3.丰富的特性</h6><blockquote>
<p>   订阅发布 Pub &#x2F; Sub 功能<br>   Key 过期策略<br>   事务<br>   支持多个 DB<br>   计数</p>
</blockquote>
<h6 id="4-持久化存储"><a href="#4-持久化存储" class="headerlink" title="4.持久化存储"></a>4.持久化存储</h6><blockquote>
<p>   Redis 提供 RDB 和 AOF 两种数据的持久化存储方案，解决内存数据库最担心的万一 Redis 挂掉，数据会消失掉。</p>
</blockquote>
<h3 id="3-Redis的缺点"><a href="#3-Redis的缺点" class="headerlink" title="3.Redis的缺点:"></a>3.Redis的缺点:</h3><blockquote>
<p>   1.由于 Redis 是内存数据库，所以，单台机器，存储的数据量，跟机器本身的内存大小。虽然 Redis 本身有Key 过期策略，但是还是需要提前预估和节约内存。如果内存增长过快，需要定期删除数据。</p>
<p>   2.redis是单线程的，单台服务器无法充分利用多核服务器的CPU</p>
</blockquote>
<h3 id="4-Redis-window-64bit-版本的使用"><a href="#4-Redis-window-64bit-版本的使用" class="headerlink" title="4.Redis -window 64bit 版本的使用&#x3D;&gt;"></a>4.Redis -window 64bit 版本的使用&#x3D;&gt;</h3><h5 id="1-安装-免安装"><a href="#1-安装-免安装" class="headerlink" title="1.安装:免安装"></a>1.安装:免安装</h5><h5 id="2-使用"><a href="#2-使用" class="headerlink" title="2.使用:"></a>2.使用:</h5><h6 id="1-双击redis-server-exe"><a href="#1-双击redis-server-exe" class="headerlink" title="1.双击redis-server.exe"></a>1.双击redis-server.exe</h6><blockquote>
<p>   Q: 如果启动报错建议查看错误日志(最难的bug,最难的是除了bug,没有bug)</p>
<ul>
<li><pre><code>      eg:没有找到配置文件
</code></pre>
</li>
<li><pre><code>      解决措施:基于cmd运行下面命令来解决(显卡的指定配置0)
</code></pre>
</li>
<li><pre><code>      redis-server.exe redis.window-service.conf(解释:指定以后面那个位置)
</code></pre>
</li>
</ul>
</blockquote>
<h6 id="2-redis-cli-exe双击-客户端测试时候使用"><a href="#2-redis-cli-exe双击-客户端测试时候使用" class="headerlink" title="2.redis-cli.exe双击(客户端测试时候使用)"></a>2.redis-cli.exe双击(客户端测试时候使用)</h6><h6 id="3-熟练掌握两个命令-set-key-value-get-key"><a href="#3-熟练掌握两个命令-set-key-value-get-key" class="headerlink" title="3.熟练掌握两个命令: set key value   ,   get key"></a>3.熟练掌握两个命令: set key value   ,   get key</h6><h3 id="5-实际操作-基于node来连接redis"><a href="#5-实际操作-基于node来连接redis" class="headerlink" title="5.实际操作(基于node来连接redis)&#x3D;&gt;"></a>5.实际操作(基于node来连接redis)&#x3D;&gt;</h3><h6 id="1-安装node-的redis-的依赖包-npm-install-redis"><a href="#1-安装node-的redis-的依赖包-npm-install-redis" class="headerlink" title="1.安装node 的redis 的依赖包, npm install redis"></a>1.安装node 的redis 的依赖包, npm install redis</h6><h6 id="2-熟练调度redis的基本api"><a href="#2-熟练调度redis的基本api" class="headerlink" title="2.熟练调度redis的基本api"></a>2.熟练调度redis的基本api</h6><h6 id="3-登陆成功后将用户的信息存储在redis里头-取而代之不用session"><a href="#3-登陆成功后将用户的信息存储在redis里头-取而代之不用session" class="headerlink" title="3.登陆成功后将用户的信息存储在redis里头,取而代之不用session"></a>3.登陆成功后将用户的信息存储在redis里头,取而代之不用session</h6><h6 id="4-每次获取用户具体的信息的时候不走数据库-直接走redis"><a href="#4-每次获取用户具体的信息的时候不走数据库-直接走redis" class="headerlink" title="4.每次获取用户具体的信息的时候不走数据库,直接走redis"></a>4.每次获取用户具体的信息的时候不走数据库,直接走redis</h6><h3 id="6-redisUtil-封装工具包"><a href="#6-redisUtil-封装工具包" class="headerlink" title="6.redisUtil(封装工具包)&#x3D;&gt;"></a>6.redisUtil(封装工具包)&#x3D;&gt;</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> redis = <span class="built_in">require</span>(<span class="string">&#x27;redis&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> client = redis.<span class="title function_">createClient</span>(<span class="number">6379</span>, <span class="string">&#x27;localhost&#x27;</span>);</span><br><span class="line"><span class="comment">// const client = redis.createClient();</span></span><br><span class="line"><span class="comment">//获取当前db中所有的key</span></span><br><span class="line"><span class="comment">// function getdbnamelist()&#123;</span></span><br><span class="line"><span class="comment">//     // 相当于命令（keys *）, 返回list，包含当前db所有key的名字</span></span><br><span class="line"><span class="comment">//     client.keys(&#x27;*&#x27;,function(err,val)&#123;</span></span><br><span class="line"><span class="comment">//         console.log(val);</span></span><br><span class="line"><span class="comment">//         //callback(val);</span></span><br><span class="line"><span class="comment">//     &#125;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 设置键值</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> dbNum 库号</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> key 键</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> value 值</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> expire 过期时间（单位：秒，可为空，为空则不过期）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> <span class="title function_">set</span> =  (<span class="params">key,value,expire,dbNum</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">typeof</span>(value)==<span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">        value=<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[redis]set key=<span class="subst">$&#123;key&#125;</span>  value=<span class="subst">$&#123;value&#125;</span>  expire=<span class="subst">$&#123;expire&#125;</span>  dbNum=<span class="subst">$&#123;dbNum&#125;</span>`</span>)</span><br><span class="line">    <span class="keyword">if</span> (!dbNum) &#123;</span><br><span class="line">        dbNum = <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        client.<span class="title function_">select</span>(dbNum,<span class="keyword">function</span> (<span class="params">err</span>) &#123;<span class="comment">//设置库</span></span><br><span class="line">            <span class="keyword">if</span> (err)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;redis set 选库失败：&#x27;</span>+err)</span><br><span class="line">                <span class="comment">// throw new Error(&#x27;redis set 选库失败：&#x27;+err);</span></span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                client.<span class="title function_">set</span>(key,value,<span class="keyword">function</span> (<span class="params">err,result</span>) &#123;<span class="comment">//设置值</span></span><br><span class="line">                    <span class="keyword">if</span> (err)&#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;redis插入失败：&#x27;</span>+err)</span><br><span class="line">                        <span class="comment">// throw new Error(&#x27;redis插入失败：&#x27;+err);</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (!<span class="built_in">isNaN</span>(expire) &amp;&amp; expire&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                            client.<span class="title function_">expire</span>(key, <span class="built_in">parseInt</span>(expire));<span class="comment">//设置过期时间</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="title function_">resolve</span>(result);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取缓存</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">key</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">dbNum</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Promise&lt;*&gt;</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> <span class="title function_">get</span> = <span class="keyword">async</span> (<span class="params">key, dbNum</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[redis]get key=<span class="subst">$&#123;key&#125;</span> dbNum=<span class="subst">$&#123;dbNum&#125;</span>`</span>)</span><br><span class="line">    <span class="keyword">if</span> (!dbNum) &#123;</span><br><span class="line">        dbNum = <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>   <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        client.<span class="title function_">select</span>(dbNum, <span class="keyword">function</span> (<span class="params">err</span>) &#123;<span class="comment">//链接库</span></span><br><span class="line">            <span class="keyword">if</span> (err)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;redis set 选库失败：&#x27;</span>+err)</span><br><span class="line">                <span class="comment">// throw new Error(&#x27;redis get 选库失败：&#x27;+err);</span></span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                client.<span class="title function_">get</span>(key, <span class="keyword">function</span> (<span class="params">err,result</span>) &#123;<span class="comment">//获取值</span></span><br><span class="line">                    <span class="keyword">if</span> (err)&#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;redis读取失败：&#x27;</span>+err)</span><br><span class="line">                        <span class="comment">// throw new Error(&#x27;redis get 获取失败：&#x27;+err);</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="title function_">resolve</span>(result);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    get,</span><br><span class="line">    set,</span><br><span class="line">    <span class="comment">// getays</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二-Mysql-关系型数据库管理系统"><a href="#二-Mysql-关系型数据库管理系统" class="headerlink" title="二.Mysql(关系型数据库管理系统)"></a>二.Mysql(关系型数据库管理系统)</h2><h3 id="1-安装Mysql准备工作"><a href="#1-安装Mysql准备工作" class="headerlink" title="1.安装Mysql准备工作"></a>1.安装Mysql准备工作</h3><blockquote>
<p>   选择引擎（innoDB(支持十五，通常我们会使用innoDB) Myisam Memory(内存数据库)）<br>   选择编码    （一定要用UTF-8）<br>   mysql<br>   版本：目前使用5.7版本<br>   安装（服务端）：<br>   安装（客户端）：<br>   REPL(mysql -u 用户名 -p 回车 再输入密码)<br>   NAVICATE (破解)<br>   NAVITOR (功能比较齐全，需自己下载)</p>
</blockquote>
<h3 id="2-mysql的运行原理"><a href="#2-mysql的运行原理" class="headerlink" title="2.mysql的运行原理:"></a>2.mysql的运行原理:</h3><pre><code>&gt; 分析器
       优化器
       执行器(缓存)
</code></pre>
<h3 id="3-实际操作"><a href="#3-实际操作" class="headerlink" title="3.实际操作&#x3D;&gt;"></a>3.实际操作&#x3D;&gt;</h3><h6 id="1-实现客户端连接数据库"><a href="#1-实现客户端连接数据库" class="headerlink" title="1.实现客户端连接数据库"></a>1.实现客户端连接数据库</h6><h6 id="2-基于客户端完成一张表的创建和配置过程"><a href="#2-基于客户端完成一张表的创建和配置过程" class="headerlink" title="2.基于客户端完成一张表的创建和配置过程"></a>2.基于客户端完成一张表的创建和配置过程</h6><h6 id="3-基于客户端完成mysql语法的基本讲解"><a href="#3-基于客户端完成mysql语法的基本讲解" class="headerlink" title="3.基于客户端完成mysql语法的基本讲解"></a>3.基于客户端完成mysql语法的基本讲解</h6><h6 id="4-NODE来操作数据库"><a href="#4-NODE来操作数据库" class="headerlink" title="4.NODE来操作数据库&#x3D;&gt;"></a>4.NODE来操作数据库&#x3D;&gt;</h6><blockquote>
<pre><code>4.1下载mysql的包
        4.2实现node操作mysql的api
        4.3实现用户注册-用户信息入库保存
        4.4实现用户登录-根据数据库用户信息验证合法性
       4.5实现获取当前用户的全部信息的功能
</code></pre>
</blockquote>
<h3 id="4-数据类型"><a href="#4-数据类型" class="headerlink" title="4.数据类型"></a>4.数据类型</h3><h5 id="1-js基础数据类型"><a href="#1-js基础数据类型" class="headerlink" title="1.js基础数据类型"></a>1.js基础数据类型</h5><blockquote>
<p>   Boolean<br>   Number<br>   Undefined<br>   Object<br>   String<br>   Function</p>
</blockquote>
<h5 id="2-数据库基本数据类型"><a href="#2-数据库基本数据类型" class="headerlink" title="2.数据库基本数据类型"></a>2.数据库基本数据类型</h5><blockquote>
<p>   tinyint  &#x3D;&gt;boolean<br>   int    &#x3D;&gt;int<br>   varchar(length-&gt;长度参数）)  &#x3D;&gt;String<br>   mediumtext  &#x3D;&#x3D;&gt;长文本<br>   datetime&#x3D;&gt; 时间Date类型</p>
</blockquote>
<h3 id="5-数据库自动填入创建时间"><a href="#5-数据库自动填入创建时间" class="headerlink" title="5.数据库自动填入创建时间"></a>5.数据库自动填入创建时间</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//在时间戳那个数据默认中输入，表示自动填入时间</span><br><span class="line">		CURRENT_TIMESTAMP</span><br></pre></td></tr></table></figure>

<h3 id="6-Mysql入门"><a href="#6-Mysql入门" class="headerlink" title="6.Mysql入门"></a>6.Mysql入门</h3><h6 id="1-mysql入门教学-概念"><a href="#1-mysql入门教学-概念" class="headerlink" title="1.mysql入门教学-概念"></a>1.mysql入门教学-概念</h6><blockquote>
<p>数据库&#x3D;》excel</p>
<p>表 &#x3D;》sheet</p>
<p>字段&#x3D;》字段</p>
<p>主键 &#x3D;》如果某个字段是逐渐，那么要求该字段的内容不能为空且不重复</p>
<p>非空&#x3D;》要求这个字段不嫩为空</p>
</blockquote>
<p>2.mysql入门教学-基础数据库语句&#x3D;&gt;</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">创建数据库：create database db_name character set utf8;</span><br><span class="line">删除数据库：drop database db_name;</span><br><span class="line">切换数据库：use dbname</span><br><span class="line">创建表：create table <span class="title function_">student</span>(id int primary key comment<span class="string">&#x27;这里写注释&#x27;</span>,name <span class="title function_">varchar</span>(<span class="number">20</span>),sex <span class="title function_">char</span>(<span class="number">1</span>) ,address <span class="title function_">varchar</span>(<span class="number">20</span>));</span><br><span class="line">删除表：drop table tb_name1,tb_name2;</span><br><span class="line">写入数据：全字段写入</span><br><span class="line">insert into student <span class="title function_">values</span>(<span class="number">001</span>,<span class="string">&#x27;刘亦菲&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;湖北武汉&#x27;</span>),(<span class="number">002</span>,<span class="string">&#x27;杨幂&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;北京&#x27;</span>)；</span><br><span class="line">写入数据：可选字段写入，其他字段自增或有默认值</span><br><span class="line">insert into <span class="title function_">student</span>(name,address) <span class="title function_">values</span>(<span class="string">&#x27;刘亦菲&#x27;</span>,<span class="string">&#x27;湖北&#x27;</span>),(<span class="string">&#x27;杨幂&#x27;</span>,,<span class="string">&#x27;北京&#x27;</span>),(<span class="string">&#x27;刘诗诗&#x27;</span>,<span class="string">&#x27;北京&#x27;</span>);</span><br><span class="line">删除数据：<span class="keyword">delete</span> <span class="keyword">from</span> tbname where 条件，只删数据，不删结构</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> student where id=<span class="number">003</span>;</span><br><span class="line">修改数据：update student set key=value,key2=value2 where 条件</span><br><span class="line">update student set address=<span class="string">&#x27;湖北&#x27;</span> where id=<span class="number">001</span>;</span><br><span class="line">查看数据：select 字段<span class="number">1</span>，字段<span class="number">2</span>，.. <span class="keyword">from</span> tbname；</span><br><span class="line">select * <span class="keyword">from</span> student;</span><br><span class="line">查看表的结构：desc tbname；</span><br><span class="line">修改表名：alter table tb_name rename to tb_name_new;</span><br><span class="line">修改字段(包括名称，类型，约束)：alter table tb_name change column_name column_name_new 数据类型 约束;</span><br><span class="line">例：alter table student change sex 性别 <span class="title function_">char</span>(<span class="number">1</span>) not <span class="literal">null</span> <span class="keyword">default</span> <span class="string">&#x27;女&#x27;</span>;</span><br><span class="line">修改字段类型：alter table tb_name modify column_name 修改后的字段类型；</span><br><span class="line">添加字段：alter table 表名 add 字段名 数据类型 约束 字段位置(first,或者after xxx);</span><br><span class="line">例：alter table tb_name add column_name decimal not <span class="literal">null</span> after cno;第一个则用first</span><br><span class="line">删除字段：alter table tb_name drop column_name；</span><br><span class="line">修改字段的默认值：alter table tb_name alter column_name set <span class="title class_">Default</span> <span class="number">666</span>;</span><br><span class="line">删除字段的默认值：alter table tb_name alter column_name drop <span class="title class_">Default</span>;</span><br><span class="line">查看建表命令：show create table tbname；内含表的编码格式</span><br><span class="line">修改数据库编码格式：alter database &lt;数据库名&gt; character set utf8;</span><br><span class="line">修改表的编码格式：alter table 表名 convert to character set utf8;</span><br><span class="line"><span class="comment">//笔记记载</span></span><br><span class="line">查询用户信息</span><br><span class="line">获取 id为<span class="number">1</span>并且account为a的用户信息</span><br><span class="line"><span class="variable constant_">SELECT</span> * <span class="variable constant_">FROM</span> <span class="string">`user`</span> a <span class="variable constant_">WHERE</span> id = <span class="number">1</span> <span class="variable constant_">AND</span> account = <span class="string">&#x27;a&#x27;</span></span><br><span class="line">获取到的信息分页  第几个开始，每页的个数</span><br><span class="line"><span class="variable constant_">SELECT</span> * <span class="variable constant_">FROM</span> <span class="string">`user`</span> <span class="variable constant_">LIMIT</span> <span class="number">1</span>,<span class="number">2</span></span><br><span class="line"><span class="comment">//根据密码分组</span></span><br><span class="line"><span class="variable constant_">SELECT</span> <span class="title function_">COUNT</span>(<span class="number">1</span>), pwd <span class="variable constant_">FROM</span> <span class="string">`user`</span> <span class="variable constant_">GROUP</span> <span class="variable constant_">BY</span> pwd</span><br><span class="line"><span class="comment">//左连接</span></span><br><span class="line"><span class="variable constant_">SELECT</span> a.<span class="property">name</span> <span class="variable constant_">AS</span> <span class="string">&#x27;用户名&#x27;</span>, b.<span class="property">name</span> <span class="variable constant_">AS</span> <span class="string">&#x27;课程&#x27;</span> <span class="variable constant_">FROM</span> <span class="string">`user`</span> a <span class="variable constant_">LEFT</span> <span class="variable constant_">JOIN</span> lesson b <span class="variable constant_">ON</span> a.<span class="property">id</span>=b.<span class="property">user_id</span></span><br><span class="line"><span class="comment">//更新修改</span></span><br><span class="line"><span class="variable constant_">UPDATE</span> <span class="string">`user`</span> <span class="variable constant_">SET</span> pwd=<span class="string">&#x27;1231&#x27;</span> <span class="variable constant_">WHERE</span> id =<span class="string">&#x27;1&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="7-mysqlUtil-数据库工具包"><a href="#7-mysqlUtil-数据库工具包" class="headerlink" title="7.mysqlUtil(数据库工具包)&#x3D;&gt;"></a>7.mysqlUtil(数据库工具包)&#x3D;&gt;</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 操作数据库模块 扫地僧 2019年5月30日19:58:46</span></span><br><span class="line"><span class="keyword">var</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> logPrefix=mysql</span><br><span class="line"><span class="keyword">var</span> pool = mysql.<span class="title function_">createPool</span>(&#123;</span><br><span class="line">    host     : <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    user     : <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    password : <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    port     : <span class="string">&#x27;3306&#x27;</span>,</span><br><span class="line">    database : <span class="string">&#x27;xunke725&#x27;</span><span class="comment">//数据库名称</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 增删改查 通用组件  同步写法</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> sql 增删改查sql 含占位符</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> params 跟占位符顺序匹配的参数数组，要求跟sql的占位符数量一样多</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> exec =  <span class="keyword">function</span> (<span class="params">sql,params</span>) &#123;</span><br><span class="line">    <span class="comment">// 返回一个 Promise</span></span><br><span class="line">        <span class="keyword">return</span>  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            pool.<span class="title function_">getConnection</span>(<span class="keyword">function</span> (<span class="params">err, connection</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">error</span>(err)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">//query执行sql语句</span></span><br><span class="line">                    connection.<span class="title function_">query</span>(sql, params, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                            <span class="variable language_">console</span>.<span class="title function_">error</span>(err)</span><br><span class="line">                          <span class="comment">//  reject(err)</span></span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;logPrefix&#125;</span>result : <span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(results)&#125;</span>`</span>);</span><br><span class="line">                            <span class="title function_">resolve</span>(results)</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// 结束会话 释放链接</span></span><br><span class="line">                        connection.<span class="title function_">release</span>()</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将所有的参数格式化成数组 参数是可变参数（可变参数在函数声明的时候不写）</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">Array</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> formatParams = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> array = [];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//js中有个变量arguments,可以访问所有传入的值</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, l = <span class="variable language_">arguments</span>.<span class="property">length</span>; i &lt; l; i++)&#123;</span><br><span class="line">        array.<span class="title function_">push</span>(<span class="variable language_">arguments</span>[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> array;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;exec, formatParams&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="8-我的数据库线程池封装代码"><a href="#8-我的数据库线程池封装代码" class="headerlink" title="8.我的数据库线程池封装代码"></a>8.我的数据库线程池封装代码</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pool = mysql.<span class="title function_">createPool</span>(&#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">user</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="string">&#x27;3306&#x27;</span>,</span><br><span class="line">    <span class="attr">database</span>: <span class="string">&#x27;vue_store&#x27;</span>,</span><br><span class="line">    <span class="comment">// timezone: &#x27;+08:00&#x27; //东八时区</span></span><br><span class="line">    <span class="attr">timezone</span>: <span class="string">&#x27;local&#x27;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 自己封装的数据模型的基类</span></span><br><span class="line"><span class="comment"> * 封装了数据库操作</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">class</span> <span class="title class_">Model</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通用查询方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; sql 要执行的SQL语句</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; params 给SQL语句的占位符进行赋值的参数数组</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="title function_">query</span>(<span class="params">sql, params</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            pool.<span class="title function_">getConnection</span>(<span class="keyword">function</span> (<span class="params">err, connection</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">error</span>(err)</span><br><span class="line">                    connection.<span class="title function_">release</span>()</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">//query执行sql语句</span></span><br><span class="line">                    connection.<span class="title function_">query</span>(sql, params, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">                        <span class="comment">//在外部用catch截取</span></span><br><span class="line">                        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                            <span class="variable language_">console</span>.<span class="title function_">error</span>(err)</span><br><span class="line">                             <span class="title function_">reject</span>(err)</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="title function_">resolve</span>(results)</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// 结束会话 释放链接</span></span><br><span class="line">                        connection.<span class="title function_">release</span>()</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="title function_">formatParams</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> array = [];</span><br><span class="line">        <span class="comment">//js中有个变量arguments,可以访问所有传入的值</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = <span class="variable language_">arguments</span>.<span class="property">length</span>; i &lt; l; i++) &#123;</span><br><span class="line">            array.<span class="title function_">push</span>(<span class="variable language_">arguments</span>[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="——————–-问题与解决二-——————"><a href="#——————–-问题与解决二-——————" class="headerlink" title="——————–&#x3D;&#x3D;(问题与解决二)&#x3D;&#x3D;——————"></a>——————–&#x3D;&#x3D;(问题与解决二)&#x3D;&#x3D;——————</h1><h1 id="遇到问题以及解决-项目day7-25-Redis-Mysql"><a href="#遇到问题以及解决-项目day7-25-Redis-Mysql" class="headerlink" title="遇到问题以及解决(项目day7_25_Redis_Mysql)&#x3D;&gt;"></a>遇到问题以及解决(项目day7_25_Redis_Mysql)&#x3D;&gt;</h1><h4 id="1-控制台报错Error-Expected-“payload”-to-be-a-plain-object"><a href="#1-控制台报错Error-Expected-“payload”-to-be-a-plain-object" class="headerlink" title="1.控制台报错Error: Expected “payload” to be a plain object"></a>1.控制台报错Error: Expected “payload” to be a plain object</h4><p>​			1.问题出现场景</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sign第一个参数必须是对象 ```````````!!!!!!!!!!!!!!!!!重点</span></span><br><span class="line"><span class="comment">//犯的错误:传入第一个参数其实并没有转化好导致报错</span></span><br><span class="line">resp.<span class="title function_">send</span>(jwtUtils.<span class="title function_">sign</span>(&#123;<span class="attr">id</span>:loginSuss[<span class="number">0</span>].<span class="property">id</span>&#125;,<span class="variable language_">global</span>.<span class="property">globalKey</span>,<span class="number">3600</span>))</span><br></pre></td></tr></table></figure>

<p>​			2)解决方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">拦截器,传入参数错误</span><br><span class="line">*错误代码：</span><br><span class="line"><span class="keyword">var</span> token = jwt.<span class="title function_">sign</span>(user, <span class="string">&#x27;app.get(superSecret)&#x27;</span>,</span><br><span class="line">解决代码：</span><br><span class="line"><span class="keyword">var</span> token = jwt.<span class="title function_">sign</span>(user.<span class="title function_">toJSON</span>(), ‘app.<span class="title function_">get</span>(superSecret)’,</span><br></pre></td></tr></table></figure>

<h4 id="2-控制台报错Uncaught-TypeError-Cannot-read-property-‘setItem’-of-undefined"><a href="#2-控制台报错Uncaught-TypeError-Cannot-read-property-‘setItem’-of-undefined" class="headerlink" title="2.控制台报错Uncaught TypeError: Cannot read property ‘setItem’ of undefined"></a>2.控制台报错Uncaught TypeError: Cannot read property ‘setItem’ of undefined</h4><p>1)问题出现场景</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//localStorage写成localstorage导致变成声明一个window变量</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">localstorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;token&quot;</span>,result);</span><br></pre></td></tr></table></figure>

<p>2)解决方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//登陆成功后写入localStorage的token ~~~~~!!!!!!!!S未大写</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;token&quot;</span>,result);</span><br></pre></td></tr></table></figure>

<h4 id="3-由于将登录以外的路径拦截-导致图片验证码以及其他的都无效且不显示"><a href="#3-由于将登录以外的路径拦截-导致图片验证码以及其他的都无效且不显示" class="headerlink" title="3.由于将登录以外的路径拦截 导致图片验证码以及其他的都无效且不显示"></a>3.由于将登录以外的路径拦截 导致图片验证码以及其他的都无效且不显示</h4><p>1)问题出现场景</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//检查路由 决定是否拦截,``````````~~~~~~~~!!!!!犯的错误:将除了登陆外的全部拦截了</span></span><br><span class="line"><span class="keyword">if</span> (path.<span class="title function_">startsWith</span>(<span class="string">&#x27;/users/login&#x27;</span>)) &#123;<span class="title function_">next</span>();&#125;</span><br></pre></td></tr></table></figure>

<p>2)解决方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//此处我将所有user的路径暂时都放出来</span></span><br><span class="line"><span class="keyword">if</span> (path.<span class="title function_">startsWith</span>(<span class="string">&#x27;/users/login&#x27;</span>)||path.<span class="title function_">startsWith</span>(<span class="string">&#x27;/user&#x27;</span>)) &#123;  <span class="title function_">next</span>();&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-Promise-await-async的使用相关问题"><a href="#4-Promise-await-async的使用相关问题" class="headerlink" title="4.Promise+await+async的使用相关问题"></a>4.Promise+await+async的使用相关问题</h4><p>1)问题出现场景</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title function_">login</span>= (<span class="params">req,resp</span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">let</span> loginSuss=  mysqlUtil.<span class="title function_">exec</span>(loginSql,mysqlUtil.<span class="title function_">formatParams</span>(name))</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>2)解决</p>
<p>mysqlUtil.exec()内是一个Promise,需要await异步转同步,否出得到的返回值将会是一个挂起的Promise对象</p>
<p>加完后要在外部login函数上加async,将整体转为异步方法,内部由await也必须加上这个</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title function_">login</span>=<span class="keyword">async</span> (<span class="params">req,resp</span>)=&gt;&#123;</span><br><span class="line"><span class="keyword">let</span> loginSuss= <span class="keyword">await</span> mysqlUtil.<span class="title function_">exec</span>(loginSql,mysqlUtil.<span class="title function_">formatParams</span>(name))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="———————–-NODE柒-————————"><a href="#———————–-NODE柒-————————" class="headerlink" title="———————–&#x3D;&#x3D;(NODE柒)&#x3D;&#x3D;————————"></a>———————–&#x3D;&#x3D;(NODE柒)&#x3D;&#x3D;————————</h1><h1 id="pm2-、nginx的概念与使用-Day7-27-28"><a href="#pm2-、nginx的概念与使用-Day7-27-28" class="headerlink" title="pm2  、nginx的概念与使用&#x3D;&gt;Day7_27~28"></a>pm2  、nginx的概念与使用&#x3D;&gt;Day7_27~28</h1><h3 id="一-pm2命令"><a href="#一-pm2命令" class="headerlink" title="一.pm2命令"></a>一.pm2命令</h3><h5 id="1-pm2的使用"><a href="#1-pm2的使用" class="headerlink" title="1.pm2的使用"></a>1.pm2的使用</h5><blockquote>
<p>   进程守卫:<br>        1.监控当前的项目的资源的消耗情况<br>        2.实现对当前的项目的热部署</p>
</blockquote>
<h5 id="2-实际操作"><a href="#2-实际操作" class="headerlink" title="2..实际操作"></a>2..实际操作</h5><h6 id="1-pm2安装"><a href="#1-pm2安装" class="headerlink" title="1.pm2安装"></a>1.pm2安装</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install  pm2 -g</span><br></pre></td></tr></table></figure>

<h6 id="2-检验是否由安装成功"><a href="#2-检验是否由安装成功" class="headerlink" title="2.检验是否由安装成功:"></a>2.检验是否由安装成功:</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm list 包名 -g</span><br></pre></td></tr></table></figure>

<h6 id="3-了解下面的命令的使用以及顺序"><a href="#3-了解下面的命令的使用以及顺序" class="headerlink" title="3.了解下面的命令的使用以及顺序"></a>3.了解下面的命令的使用以及顺序</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pm2 init    				##创建pm2配置文件</span><br><span class="line">pm2 start bin/www   ##启动服务器 bin/www表示要运行的脚本,express项目就</span><br><span class="line">pm2 list            ##查看运行状态</span><br><span class="line">pm2 log             ##查看日志</span><br><span class="line">pm2 restart www     ##重启应用 www是 pm2启动进程的名称</span><br><span class="line">pm2 stop www        ##停止应用 www是 pm2启动进程的名称(也可以输入id)</span><br><span class="line">pm2 delete www      ##卸载应用(即终止运行) www是 pm2启动进程的名称(也可以输入id)</span><br><span class="line">pm2 monit           ##实时监控cpu</span><br></pre></td></tr></table></figure>

<h6 id="4-ecosystem-config-js修改"><a href="#4-ecosystem-config-js修改" class="headerlink" title="4.ecosystem.config.js修改"></a>4.ecosystem.config.js修改</h6><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  apps : [</span><br><span class="line">      <span class="comment">//删除apps里面所有元素,这些都是多余的,然后添加以下元素</span></span><br><span class="line">      &#123;</span><br><span class="line">          <span class="attr">script</span>: <span class="string">&#x27;bin/www&#x27;</span>,</span><br><span class="line">          <span class="comment">//监听</span></span><br><span class="line">          <span class="attr">watch</span>: <span class="literal">true</span></span><br><span class="line">      &#125;,</span><br><span class="line">  ],</span><br></pre></td></tr></table></figure>



<h3 id="二-Nginx"><a href="#二-Nginx" class="headerlink" title="二.Nginx"></a>二.<strong>Nginx</strong></h3><h4 id="1-了解Nginx"><a href="#1-了解Nginx" class="headerlink" title="1. 了解Nginx:"></a>1. 了解Nginx:</h4><blockquote>
<p>   Nginx是一款<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%BD%BB%E9%87%8F%E7%BA%A7/10002835">轻量级</a>的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Web/150564">Web</a> 服务器&#x2F;<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/7793488">反向代理</a>服务器及<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6/111106">电子邮件</a>（IMAP&#x2F;POP3）代理服务器，在BSD-like 协议下发行。其特点是占有内存少，<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%B9%B6%E5%8F%91/11024806">并发</a>能力强，事实上nginx的并发能力在同类型的网页服务器中表现较好，中国大陆使用nginx网站用户有：百度、<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%BA%AC%E4%B8%9C/210931">京东</a>、<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%96%B0%E6%B5%AA/125692">新浪</a>、<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%BD%91%E6%98%93/185754">网易</a>、<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%85%BE%E8%AE%AF/112204">腾讯</a>、<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%B7%98%E5%AE%9D/145661">淘宝</a>等。</p>
</blockquote>
<h4 id="2-Nginx的作用"><a href="#2-Nginx的作用" class="headerlink" title="2.Nginx的作用:"></a>2.Nginx的作用:</h4><blockquote>
<p>1)反向代理解决跨域问题<br>    2)负载均衡<br>    3)翻墙……</p>
</blockquote>
<h4 id="3-Nginx的三个bat文件"><a href="#3-Nginx的三个bat文件" class="headerlink" title="3.Nginx的三个bat文件&#x3D;&gt;"></a>3.Nginx的三个bat文件&#x3D;&gt;</h4><h6 id="3-1-start-bat"><a href="#3-1-start-bat" class="headerlink" title="3.1)start.bat&#x3D;&gt;"></a>3.1)start.bat&#x3D;&gt;</h6><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">start</span> nginx -c ./conf/nginx.conf</span><br><span class="line"><span class="built_in">echo</span> success</span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure>

<h6 id="3-2-stop-bat"><a href="#3-2-stop-bat" class="headerlink" title="3.2)stop.bat&#x3D;&gt;"></a>3.2)stop.bat&#x3D;&gt;</h6><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nginx.exe -s stop</span><br><span class="line"><span class="built_in">echo</span> success</span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure>

<h6 id="3-3-reload-bat"><a href="#3-3-reload-bat" class="headerlink" title="3.3)reload.bat&#x3D;&gt;"></a>3.3)reload.bat&#x3D;&gt;</h6><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nginx.exe -s reload</span><br><span class="line"><span class="built_in">echo</span> success</span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure>

<h4 id="4-Nginx实操"><a href="#4-Nginx实操" class="headerlink" title="4.Nginx实操&#x3D;&gt;"></a>4.Nginx实操&#x3D;&gt;</h4><h6 id="4-1-配置start-bat-stop-bat-reload-bat"><a href="#4-1-配置start-bat-stop-bat-reload-bat" class="headerlink" title="4.1)配置start.bat stop.bat reload.bat"></a>4.1)配置start.bat stop.bat reload.bat</h6><ol>
<li>start.bat :启动nginx(通过start.bat启动的nginx,千万不能多次启动,否则会出现多个nginx实例,这个时候stop来不及了  stop只能关闭最后一个,但是如果真的犯错了,怎么关闭以前呢:在任务栏,右击打开任务管理器&#x3D;&#x3D;&gt;进入到详细服务列表,找到nginx服务,统统结束)</li>
<li>stop.bat :停用nginx(在start之后可以用)</li>
<li>reload.bat:重启nginx(在start之后可以用)</li>
<li>通过cmd执行start.bat来启动nginx启动之后,千万别关闭串口</li>
</ol>
<h6 id="4-2-nginx出现访问不了的情况"><a href="#4-2-nginx出现访问不了的情况" class="headerlink" title="4.2)nginx出现访问不了的情况&#x3D;&gt;"></a>4.2)nginx出现访问不了的情况&#x3D;&gt;</h6><ol>
<li>只有一种:配置出现问题&#x3D;&gt;学会看日志: E:\nginx\logs\error.log去看日志内容</li>
</ol>
<h4 id="5-配置文件"><a href="#5-配置文件" class="headerlink" title="5.配置文件&#x3D;&gt;"></a>5.配置文件&#x3D;&gt;</h4><h5 id="5-1-配置文件位置"><a href="#5-1-配置文件位置" class="headerlink" title="5.1)配置文件位置:"></a>5.1)配置文件位置:</h5><blockquote>
<p>   E:\nginx\conf\nginx.conf</p>
</blockquote>
<h5 id="5-2-配置文件服务器配置部分解释"><a href="#5-2-配置文件服务器配置部分解释" class="headerlink" title="5.2)配置文件服务器配置部分解释&#x3D;&gt;"></a>5.2)配置文件服务器配置部分解释&#x3D;&gt;</h5><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen       <span class="number">80</span>;</span><br><span class="line">        #//监听的域名</span><br><span class="line">        //本地IP地址</span><br><span class="line">        server_name  localhost;</span><br><span class="line">        #charset koi8-r;</span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line">           #//如果是localhost <span class="number">80</span>端口   就访问根目录下的index.html</span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">        //测试静态文件服务器配置(注意斜杠)</span><br><span class="line">        location /xk &#123;</span><br><span class="line">              alias  E:/fyWebStrom/Xunke_Code/day7_27_28/public;</span><br><span class="line">		&#125;</span><br><span class="line">		location /cross/ &#123;</span><br><span class="line">			proxy_pass  http://localhost:<span class="number">3000</span>/;</span><br><span class="line">			add_header  to http://localhost:<span class="number">3000</span>;</span><br><span class="line">		&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="5-3-静态文件服务器配置-注意斜杠"><a href="#5-3-静态文件服务器配置-注意斜杠" class="headerlink" title="5.3)静态文件服务器配置(注意斜杠)"></a>5.3)静态文件服务器配置(注意斜杠)</h5><h6 id="5-3-1-方式一"><a href="#5-3-1-方式一" class="headerlink" title="5.3.1)方式一:"></a>5.3.1)方式一:</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">location /qn &#123; alias  E:/fyWebStrom/Xunke_Code/day7_27_28/public;	&#125;</span><br><span class="line">  alias表示别名,意思就是当我们请求的uri里头包含了qn,那么就会自动去访问alias指向的路径下的文件</span><br><span class="line">    eg:</span><br><span class="line">    http://localhost/qn/test.html</span><br><span class="line">    表示:请求alias路径下的test.html</span><br></pre></td></tr></table></figure>

<h6 id="5-3-2-方式二"><a href="#5-3-2-方式二" class="headerlink" title="5.3.2)方式二:"></a>5.3.2)方式二:</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location  /qn&#123;</span><br><span class="line">    root E:/fyWebStrom/Xunke_Code/day7_27_28/public/Demo.html</span><br><span class="line">    //表示根, 请求root路径下的qn文件夹下的test.html</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-跨域代理"><a href="#6-跨域代理" class="headerlink" title="6.跨域代理&#x3D;&gt;"></a>6.跨域代理&#x3D;&gt;</h4><h5 id="6-1-配置文件配置"><a href="#6-1-配置文件配置" class="headerlink" title="6.1)配置文件配置:"></a>6.1)配置文件配置:</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line">        #charset koi8-r;</span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line">        //nginx跨域配置</span><br><span class="line">            location /cross/ &#123;</span><br><span class="line">        proxy_pass http://localhost:3000/;</span><br><span class="line">        add_header to http://localhost:3000;</span><br><span class="line">   &#125; &#125;</span><br></pre></td></tr></table></figure>

<h5 id="6-2-配置proxy-pass代理转发四种方式"><a href="#6-2-配置proxy-pass代理转发四种方式" class="headerlink" title="6.2)配置proxy_pass代理转发四种方式&#x3D;&gt;"></a>6.2)配置proxy_pass代理转发四种方式&#x3D;&gt;</h5><h6 id="6-2-1-配置路径原理"><a href="#6-2-1-配置路径原理" class="headerlink" title="6.2.1)配置路径原理"></a>6.2.1)配置路径原理</h6><blockquote>
<p>   在nginx中配置proxy_pass代理转发时，如果在proxy_pass后面的url加&#x2F;，表示绝对根路径；如果没有&#x2F;，表示相对路径，把匹配的路径部分也给代理走。</p>
</blockquote>
<p>假设下面四种情况分别用 <a target="_blank" rel="noopener" href="http://192.168.1.1/proxy/test.html">http://192.168.1.1/proxy/test.html</a> 进行访问:</p>
<h6 id="6-2-1-第一种方法"><a href="#6-2-1-第一种方法" class="headerlink" title="6.2.1)第一种方法:"></a>6.2.1)第一种方法:</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location /proxy/ &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1/;</span><br><span class="line">&#125;</span><br><span class="line">代理到URL：http://127.0.0.1/test.html</span><br></pre></td></tr></table></figure>

<h6 id="6-2-2-第二种方法（相对于第一种，最后少一个-）"><a href="#6-2-2-第二种方法（相对于第一种，最后少一个-）" class="headerlink" title="6.2.2)第二种方法（相对于第一种，最后少一个 &#x2F; ）:"></a>6.2.2)第二种方法（相对于第一种，最后少一个 &#x2F; ）:</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location /proxy/ &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1;</span><br><span class="line">&#125;</span><br><span class="line">代理到URL：http://127.0.0.1/proxy/test.html</span><br></pre></td></tr></table></figure>

<h6 id="6-2-3-第三种方法"><a href="#6-2-3-第三种方法" class="headerlink" title="6.2.3)第三种方法:"></a>6.2.3)第三种方法:</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location /proxy/ &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1/aaa/;</span><br><span class="line">&#125;</span><br><span class="line">代理到URL：http://127.0.0.1/aaa/test.html</span><br></pre></td></tr></table></figure>

<h6 id="6-2-4-第四种方法-相对于第三种，最后少一个-）"><a href="#6-2-4-第四种方法-相对于第三种，最后少一个-）" class="headerlink" title="6.2.4)第四种方法(相对于第三种，最后少一个 &#x2F; ）:"></a>6.2.4)第四种方法(相对于第三种，最后少一个 &#x2F; ）:</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location /proxy/ &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1/aaa;</span><br><span class="line">&#125;</span><br><span class="line">代理到URL：http://127.0.0.1/aaatest.html</span><br></pre></td></tr></table></figure>

<h4 id="7-Niginx配置文件及其跨域原理"><a href="#7-Niginx配置文件及其跨域原理" class="headerlink" title="7.Niginx配置文件及其跨域原理&#x3D;&gt;"></a>7.Niginx配置文件及其跨域原理&#x3D;&gt;</h4><h6 id="①-server表示启动一个代理服务器"><a href="#①-server表示启动一个代理服务器" class="headerlink" title="① server表示启动一个代理服务器"></a>① server表示启动一个代理服务器</h6><h6 id="②-该代理服务器也是静态文服-静态文件要通过代理服务器来访问"><a href="#②-该代理服务器也是静态文服-静态文件要通过代理服务器来访问" class="headerlink" title="② 该代理服务器也是静态文服 (静态文件要通过代理服务器来访问)"></a>② 该代理服务器也是静态文服 (静态文件要通过代理服务器来访问)</h6><pre><code>             1)因为代理服务器只能监听代理服务器的端口
                    2)所以前端发出的所有请求一定是基于80端口去发出
         			  3)这样子,前端的所有跨域请求才可以被监听到
                    4)才能实现 前端和代理服务器之间的不跨域
</code></pre>
<h6 id="③-80-表示监听80端口-所以最终我们的前端资源一定是部署在80端口上"><a href="#③-80-表示监听80端口-所以最终我们的前端资源一定是部署在80端口上" class="headerlink" title="③ 80 表示监听80端口 所以最终我们的前端资源一定是部署在80端口上"></a>③ 80 表示监听80端口 所以最终我们的前端资源一定是部署在80端口上</h6><pre><code>             1)通过相对路径 html
           		 2)通过绝对路径  静态文服
</code></pre>
<h6 id="④-location-cross"><a href="#④-location-cross" class="headerlink" title="④ location &#x2F;cross"></a>④ location &#x2F;cross</h6><pre><code>             1)服务端的接口的uri ,不一定要cross(联想alias,它只是一个规则,并没有表示真正的意图)
                        http://localhost/cross/cross 后面的cross才是我们正要去访问的uri
</code></pre>
<h6 id="⑤-proxy-pass"><a href="#⑤-proxy-pass" class="headerlink" title="⑤ proxy_pass"></a>⑤ proxy_pass</h6><p>​    			  1) 表示我们真正想要请求的地址是……</p>
<h6 id="⑥-add-header"><a href="#⑥-add-header" class="headerlink" title="⑥ add_header"></a>⑥ add_header</h6><pre><code>              2) 就是我们在请求成功之后 响应头要添加的内容
</code></pre>
<h6 id="⑦练习"><a href="#⑦练习" class="headerlink" title="⑦练习:"></a>⑦练习:</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:81/cross/cross/get  (跨域不成功) 端口无法监听到</span><br><span class="line"> http://localhost:81/cross1/cross/get (跨域不成功)找不到路径且端口也不正确</span><br><span class="line"> http://localhost:80/cross/cross/get  (跨域成功)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>author(洪吉林)2020_7_16~28笔记</p>
</blockquote>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="https://k705.github.io/2024/04/08/Nodejs-A_Node%E7%AC%94%E8%AE%B0%E6%80%BB%E7%BA%B2/" title="node笔记总纲" target="_blank" rel="external">https://k705.github.io/2024/04/08/Nodejs-A_Node笔记总纲/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/cofess" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="./images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/cofess" target="_blank"><span class="text-dark">KK</span><small class="ml-1x">前端工程师</small></a></h3>
        <div>个人简介。</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="./2024/04/08/Nodejs-day7_16_node%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/" title="NODE基本语法"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="./2024/04/08/Nodejs-day7_17_%E8%AF%B7%E6%B1%82req%E5%92%8C%E5%93%8D%E5%BA%94%E5%8E%9F%E7%90%86resp(%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BC%A0%E8%BE%93%E7%AE%80%E5%8D%95%E7%A4%BA%E4%BE%8B)/" title="请求req和响应原理resp"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="./images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="./images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/cofess" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://weibo.com/cofess" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="https://twitter.com/iwebued" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
        <li><a href="https://www.behance.net/cofess" target="_blank" title="Behance" data-toggle=tooltip data-placement=top><i class="icon icon-behance"></i></a></li>
        
        <li><a href="./atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="./js/plugin.min.js"></script>


<script src="./js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: './',
        CONTENT_URL: './content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="./js/insight.js"></script>






   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: '',
    appKey: '',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: false
  });
  </script>

     







</body>
</html>